<!DOCTYPE html>
<!-- saved from url=(0076)https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Costin Leau, Jennifer Hickey, Christoph Strobl, Thomas Darimont, Mark Paluch, Jay Bryant">
<title>Spring Data Redis</title>
<link rel="stylesheet" href="./Spring Data Redis_files/spring.css">
<link rel="stylesheet" href="./Spring Data Redis_files/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>Spring Data Redis</h1>
<div class="details">
<span id="author" class="author">Costin Leau, Jennifer Hickey, Christoph Strobl, Thomas Darimont, Mark Paluch, Jay Bryant</span><br>
<span id="revnumber">version 1.8.12.RELEASE,</span>
<span id="revdate">2018-05-08</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>© 2011-2018 The original authors.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.
</td>
</tr>
</tbody></table>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_preface">Preface</a>
<ul class="sectlevel1">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-features">1. New Features</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1.8.0">1.1. New in Spring Data Redis 1.8</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1.7.0">1.2. New in Spring Data Redis 1.7</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1-6-0">1.3. New in Spring Data Redis 1.6</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1-5-0">1.4. New in Spring Data Redis 1.5</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#introduction">Introduction</a>
<ul class="sectlevel1">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#why-spring-redis">2. Why Spring Data Redis?</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#requirements">3. Requirements</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started">4. Getting Started</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps">4.1. First Steps</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps:spring">4.1.1. Learning Spring</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps:nosql">4.1.2. Learning NoSQL and Key Value Stores</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps:samples">4.1.3. Trying out the Samples</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:help">4.2. Need Help?</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:help:community">4.2.1. Community Support</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:help:professional">4.2.2. Professional Support</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:up-to-date">4.3. Following Development</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#reference">Reference Documentation</a>
<ul class="sectlevel1">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis">5. Redis support</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:requirements">5.1. Redis Requirements</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:architecture">5.2. Redis Support High-level View</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors">5.3. Connecting to Redis</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:connection">5.3.1. RedisConnection and RedisConnectionFactory</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:jedis">5.3.2. Configuring the Jedis Connector</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:jredis">5.3.3. Configuring JRedis connector (Deprecated since 1.7)</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:srp">5.3.4. Configuring SRP connector (Deprecated since 1.7)</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:lettuce">5.3.5. Configuring the Lettuce connector</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:sentinel">5.4. Redis Sentinel Support</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:template">5.5. Working with Objects through RedisTemplate</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:string">5.6. String-focused Convenience Classes</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:serializer">5.7. Serializers</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.hashmappers.root">5.8. Hash mapping</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_hash_mappers">5.8.1. Hash Mappers</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.hashmappers.jackson2">5.8.2. Jackson2HashMapper</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#pubsub">5.9. Redis Messaging (Pub/Sub)</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:publish">5.9.1. Publishing (Sending Messages)</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:subscribe">5.9.2. Subscribing (Receiving Messages)</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#tx">5.10. Redis Transactions</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#tx.spring">5.10.1. @Transactional Support</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#pipeline">5.11. Pipelining</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#scripting">5.12. Redis Scripting</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:support">5.13. Support Classes</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:support:cache-abstraction">5.13.1. Support for the Spring Cache Abstraction</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#cluster">6. Redis Cluster</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_enabling_redis_cluster">6.1. Enabling Redis Cluster</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_working_with_redis_cluster_connection">6.2. Working With Redis Cluster Connection</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_working_with_code_redistemplate_code_and_code_clusteroperations_code">6.3. Working with <code>RedisTemplate</code> and <code>ClusterOperations</code></a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories">7. Redis Repositories</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.usage">7.1. Usage</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.mapping">7.2. Object-to-Hash Mapping</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_customizing_type_mapping">7.2.1. Customizing Type Mapping</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.keyspaces">7.3. Keyspaces</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes">7.4. Secondary Indexes</a>
<ul class="sectlevel3">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes.simple">7.4.1. Simple Property Index</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes.geospatial">7.4.2. Geospatial Index</a></li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.expirations">7.5. Time To Live</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.references">7.6. Persisting References</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.partial-updates">7.7. Persisting Partial Updates</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.queries">7.8. Queries and Query Methods</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.cluster">7.9. Redis Repositories Running on a Cluster</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.cdi-integration">7.10. CDI Integration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendixes">Appendixes</a>
<ul class="sectlevel1">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendix:schema">Appendix A: Schema</a></li>
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendix:command-reference">Appendix B: Command Reference</a>
<ul class="sectlevel2">
<li><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_supported_commands">Supported Commands</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_preface" class="sect0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_preface"></a>Preface</h1>
<div class="openblock partintro">
<div class="content">
The Spring Data Redis project applies core Spring concepts to the development of solutions by using a key-value style data store. We provide a “template” as a high-level abstraction for sending and receiving messages. You may notice similarities to the JDBC support in the Spring Framework.
</div>
</div>
<div class="sect1">
<h2 id="new-features"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-features"></a>1. New Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section briefly covers items that are new and noteworthy in the latest releases.</p>
</div>
<div class="sect2">
<h3 id="new-in-1.8.0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1.8.0"></a>1.1. New in Spring Data Redis 1.8</h3>
<div class="ulist">
<ul>
<li>
<p>Upgrade to Jedis 2.9.</p>
</li>
<li>
<p>Upgrade to <code>Lettuce</code> 4.2 (Note: Lettuce 4.2 requires Java 8).</p>
</li>
<li>
<p>Support for Redis <a href="http://redis.io/commands#geo">GEO</a> commands.</p>
</li>
<li>
<p>Support for Geospatial Indexes using Spring Data Repository abstractions (see <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes.geospatial">Geospatial Index</a>).</p>
</li>
<li>
<p><code>MappingRedisConverter</code>-based <code>HashMapper</code> implementation (see <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.hashmappers.root">Hash mapping</a>).</p>
</li>
<li>
<p>Support for <code>PartialUpdate</code> in repositories (see <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.partial-updates">Persisting Partial Updates</a>).</p>
</li>
<li>
<p>SSL support for connections to Redis cluster.</p>
</li>
<li>
<p>Support for <code>client name</code> through <code>ConnectionFactory</code> when using Jedis.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="new-in-1.7.0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1.7.0"></a>1.2. New in Spring Data Redis 1.7</h3>
<div class="ulist">
<ul>
<li>
<p>Support for <a href="http://redis.io/topics/cluster-tutorial">RedisCluster</a>.</p>
</li>
<li>
<p>Support for Spring Data Repository abstractions (see <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories">Redis Repositories</a>).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="new-in-1-6-0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1-6-0"></a>1.3. New in Spring Data Redis 1.6</h3>
<div class="ulist">
<ul>
<li>
<p>The <code>Lettuce</code> Redis driver switched from <a href="https://github.com/wg/lettuce">wg/lettuce</a> to <a href="https://github.com/mp911de/lettuce">mp911de/lettuce</a>.</p>
</li>
<li>
<p>Support for <code>ZRANGEBYLEX</code>.</p>
</li>
<li>
<p>Enhanced range operations for <code>ZSET</code>, including <code>+inf</code> / <code>-inf</code>.</p>
</li>
<li>
<p>Performance improvements in <code>RedisCache</code>, now releasing connections earlier.</p>
</li>
<li>
<p>Generic Jackson2 <code>RedisSerializer</code> making use of Jackson’s polymorphic deserialization.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="new-in-1-5-0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#new-in-1-5-0"></a>1.4. New in Spring Data Redis 1.5</h3>
<div class="ulist">
<ul>
<li>
<p>Add support for Redis HyperLogLog commands: <code>PFADD</code>, <code>PFCOUNT</code>, and <code>PFMERGE</code>.</p>
</li>
<li>
<p>Configurable <code>JavaType</code> lookup for Jackson-based <code>RedisSerializers</code>.</p>
</li>
<li>
<p><code>PropertySource</code>-based configuration for connecting to Redis Sentinel (see: <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:sentinel">Redis Sentinel Support</a>).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="introduction" class="sect0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#introduction"></a>Introduction</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>This document is the reference guide for Spring Data Redis (SDR) Support. It explains Key-Value module concepts and semantics and the syntax for various stores namespaces.</p>
</div>
<div class="paragraph">
<p>For an introduction to key-value stores, Spring, or Spring Data examples, see <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started">Getting Started</a>. This documentation refers only to Spring Data Redis Support and assumes the user is familiar with key-value storage and Spring concepts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="why-spring-redis"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#why-spring-redis"></a>2. Why Spring Data Redis?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Spring Framework is the leading full-stack Java/JEE application framework. It provides a lightweight container and a non-invasive programming model enabled by the use of dependency injection, AOP, and portable service abstractions.</p>
</div>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/NoSQL">NoSQL</a> storage systems provide an alternative to classical RDBMS for horizontal scalability and speed. In terms of implementation, key-value stores represent one of the largest (and oldest) members in the NoSQL space.</p>
</div>
<div class="paragraph">
<p>The Spring Data Redis (SDR) framework makes it easy to write Spring applications that use the Redis key-value store by eliminating the redundant tasks and boilerplate code required for interacting with the store through Spring’s excellent infrastructure support.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="requirements"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#requirements"></a>3. Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Data Redis 2.x binaries require JDK level 8.0 and above and <a href="https://projects.spring.io/spring-framework/">Spring Framework</a> 4.3.17.RELEASE and above.</p>
</div>
<div class="paragraph">
<p>In terms of key-value stores, <a href="http://redis.io/">Redis</a> 2.6.x or higher is required. Spring Data Redis is currently tested against the latest 4.0 release.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="get-started"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started"></a>4. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides an easy-to-follow guide for getting started with the Spring Data Redis module.</p>
</div>
<div class="sect2">
<h3 id="get-started:first-steps"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps"></a>4.1. First Steps</h3>
<div class="paragraph">
<p>As explained in <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#why-spring-redis">Why Spring Data Redis?</a>, Spring Data Redis (SDR) provides integration between the Spring framework and the Redis key-value store. Consequently, you should become acquainted with both of these frameworks. Throughout the SDR documentation, each section provides links to relevant resources. However, you should become familiar with these topics before reading this guide.</p>
</div>
<div class="sect3">
<h4 id="get-started:first-steps:spring"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps:spring"></a>4.1.1. Learning Spring</h4>
<div class="paragraph">
<p>Spring Data uses Spring framework’s <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/spring-core.html">core</a> functionality, such as the <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html">IoC</a> container, <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/resources.html">resource</a> abstract, and the <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/aop.html">AOP</a> infrastructure. While it is not important to know the Spring APIs, understanding the concepts behind them is important. At a minimum, the idea behind IoC should be familiar. That being said, the more knowledge you have about the Spring, the faster you can pick up Spring Data Redis. In addition to the Spring Framework’s comprehensive documentation, there are a lot of articles, blog entries, and books on the matter. The Spring Guides <a href="https://spring.io/guides">home page</a> offer a good place to start. In general, this should be the starting point for developers wanting to try Spring Data Redis.</p>
</div>
</div>
<div class="sect3">
<h4 id="get-started:first-steps:nosql"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps:nosql"></a>4.1.2. Learning NoSQL and Key Value Stores</h4>
<div class="paragraph">
<p>NoSQL stores have taken the storage world by storm. It is a vast domain with a plethora of solutions, terms, and patterns (to make things worse, even the term itself has multiple <a href="https://www.google.com/search?q=nosoql+acronym">meanings</a>). While some of the principles are common, it is crucial that you be familiar to some degree with the stores supported by SDR. The best way to get acquainted with these solutions is to read their documentation and follow their examples. It usually does not take more then five to ten minutes to go through them and, if you come from an RDMBS-only background, many times these exercises can be eye-openers.</p>
</div>
</div>
<div class="sect3">
<h4 id="get-started:first-steps:samples"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:first-steps:samples"></a>4.1.3. Trying out the Samples</h4>
<div class="paragraph">
<p>One can find various samples for key-value stores in the dedicated Spring Data example repo, at <a href="https://github.com/spring-projects/spring-data-keyvalue-examples">http://github.com/spring-projects/spring-data-keyvalue-examples</a>. For Spring Data Redis, you should pay particular attention to the <code>retwisj</code> sample, a Twitter-clone built on top of Redis that can be run locally or be deployed into the cloud. See its <a href="http://static.springsource.org/spring-data/data-keyvalue/examples/retwisj/current/">documentation</a>, the following blog <a href="http://blog.springsource.com/2011/04/27/getting-started-redis-spring-cloud-foundry/">entry</a> for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="get-started:help"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:help"></a>4.2. Need Help?</h3>
<div class="paragraph">
<p>If you encounter issues or you are just looking for advice, use one of the links below:</p>
</div>
<div class="sect3">
<h4 id="get-started:help:community"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:help:community"></a>4.2.1. Community Support</h4>
<div class="paragraph">
<p>The Spring Data tag on <a href="https://stackoverflow.com/questions/tagged/spring-data">Stack Overflow</a> is a message board for all Spring Data (not just Redis) users to share information and help each other. Note that registration is needed <strong>only</strong> for posting.</p>
</div>
</div>
<div class="sect3">
<h4 id="get-started:help:professional"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:help:professional"></a>4.2.2. Professional Support</h4>
<div class="paragraph">
<p>Professional, from-the-source support, with guaranteed response time, is available from <a href="http://www.gopivotal.com/">Pivotal Software, Inc.</a>, the company behind Spring Data and Spring.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="get-started:up-to-date"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#get-started:up-to-date"></a>4.3. Following Development</h3>
<div class="paragraph">
<p>For information on the Spring Data source code repository, nightly builds, and snapshot artifacts, see the Spring Data home <a href="https://spring.io/spring-data">page</a>.</p>
</div>
<div class="paragraph">
<p>You can help make Spring Data best serve the needs of the Spring community by interacting with developers on Stack Overflow at either
<a href="https://stackoverflow.com/questions/tagged/spring-data">spring-data</a> or <a href="https://stackoverflow.com/questions/tagged/spring-data-redis">spring-data-redis</a>.</p>
</div>
<div class="paragraph">
<p>If you encounter a bug or want to suggest an improvement (including to this documentation), please create a ticket on the Spring Data issue <a href="https://jira.spring.io/browse/DATAREDIS">tracker</a>.</p>
</div>
<div class="paragraph">
<p>To stay up to date with the latest news and announcements in the Spring eco system, subscribe to the Spring Community <a href="https://spring.io/">Portal</a>.</p>
</div>
<div class="paragraph">
<p>Lastly, you can follow the Spring <a href="https://spring.io/blog/">blog</a> or the project team (<a href="https://twitter.com/thomasdarimont">Thomas</a> and <a href="https://twitter.com/stroblchristoph">Christoph</a>) on Twitter.</p>
</div>
</div>
</div>
</div>
<h1 id="reference" class="sect0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#reference"></a>Reference Documentation</h1>
<div class="openblock partintro">
<div class="content">
<h2 id="_document_structure" class="float">Document structure</h2>
<div class="paragraph">
<p>This part of the reference documentation explains the core functionality offered by Spring Data Redis.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis">Redis support</a> introduces the Redis module feature set.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="redis"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis"></a>5. Redis support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the key-value stores supported by Spring Data is <a href="http://redis.io/">Redis</a>. To quote the Redis project home page:</p>
</div>
<div class="quoteblock">
<blockquote>
Redis is an advanced key-value store. It is similar to memcached but the dataset is not volatile, and values can be strings, exactly like in memcached, but also lists, sets, and ordered sets. All this data types can be manipulated with atomic operations to push/pop elements, add/remove elements, perform server side union, intersection, difference between sets, and so forth. Redis supports different kind of sorting abilities.
</blockquote>
</div>
<div class="paragraph">
<p>Spring Data Redis provides easy configuration and access to Redis from Spring applications. It offers both low-level and high-level abstractions for interacting with the store, freeing the user from infrastructural concerns.</p>
</div>
<div class="sect2">
<h3 id="redis:requirements"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:requirements"></a>5.1. Redis Requirements</h3>
<div class="paragraph">
<p>Spring Data Redis requires Redis 2.6 or above and Java SE 6.0 or above . In terms of language bindings (or connectors), Spring Redis integrates with <a href="https://github.com/xetorthio/jedis">Jedis</a>, <a href="https://github.com/alphazero/jredis">JRedis</a> (Deprecated since 1.7), <a href="https://github.com/spullara/redis-protocol">SRP</a> (Deprecated since 1.7) and <a href="https://github.com/wg/lettuce">Lettuce</a>, four popular open-source Java libraries for Redis. If you are aware of any other connector that we should be integrating with please send us feedback.</p>
</div>
</div>
<div class="sect2">
<h3 id="redis:architecture"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:architecture"></a>5.2. Redis Support High-level View</h3>
<div class="paragraph">
<p>The Redis support provides several components. For most tasks, the high-level abstractions and support services are the best choice. Note that, at any point, you can move between layers. For example, you can get a low-level connection (or even the native library) to communicate directly with Redis.</p>
</div>
</div>
<div class="sect2">
<h3 id="redis:connectors"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors"></a>5.3. Connecting to Redis</h3>
<div class="paragraph">
<p>One of the first tasks when using Redis and Spring is to connect to the store through the IoC container. To do that, a Java connector (or binding) is required. No matter the library you choose, you need to use only one set of Spring Data Redis APIs (which behaves consistently across all connectors): the <code>org.springframework.data.redis.connection</code> package and its <code>RedisConnection</code> and <code>RedisConnectionFactory</code> interfaces for working with and retrieving active connections to Redis.</p>
</div>
<div class="sect3">
<h4 id="redis:connectors:connection"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:connection"></a>5.3.1. RedisConnection and RedisConnectionFactory</h4>
<div class="paragraph">
<p><code>RedisConnection</code> provides the core building block for Redis communication, as it handles the communication with the Redis back end. It also automatically translates the underlying connecting library exceptions to Spring’s consistent DAO exception <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/dao.html#dao-exceptions">hierarchy</a> so that you can switch the connectors without any code changes, as the operation semantics remain the same.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the corner cases where the native library API is required, <code>RedisConnection</code> provides a dedicated method (<code>getNativeConnection</code>) that returns the raw, underlying object used for communication.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Active <code>RedisConnection</code> objects are created through <code>RedisConnectionFactory</code>. In addition, the factory acts as <code>PersistenceExceptionTranslator</code> objects, meaning that, once declared, they let you do transparent exception translation. For example, you can do exception translation through the use of the <code>@Repository</code> annotation and AOP. For more information, see the dedicated <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/orm.html#orm-exception-translation">section</a> in the Spring Framework documentation.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Depending on the underlying configuration, the factory can return a new connection or an existing connection (when a pool or shared native connection is used).
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The easiest way to work with a <code>RedisConnectionFactory</code> is to configure the appropriate connector through the IoC container and inject it into the using class.</p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Unfortunately, currently, not all connectors support all Redis features. When invoking a method on the Connection API that is unsupported by the underlying library, an <code>UnsupportedOperationException</code> is thrown.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="redis:connectors:jedis"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:jedis"></a>5.3.2. Configuring the Jedis Connector</h4>
<div class="paragraph">
<p><a href="https://github.com/xetorthio/jedis">Jedis</a> is one of the connectors supported by the Spring Data Redis module through the <code>org.springframework.data.redis.connection.jedis</code> package. In its simplest form, the Jedis configuration looks as follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="com">&lt;!-- Jedis ConnectionFactory --&gt;</span><span class="pln">
  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"jedisConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For production use, however, you might want to tweak settings such as the host or password, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"jedisConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span><span class="pln"> </span><span class="atn">p:host-name</span><span class="pun">=</span><span class="atv">"server"</span><span class="pln"> </span><span class="atn">p:port</span><span class="pun">=</span><span class="atv">"6379"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis:connectors:jredis"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:jredis"></a>5.3.3. Configuring JRedis connector (Deprecated since 1.7)</h4>
<div class="paragraph">
<p><a href="https://github.com/alphazero/jredis">JRedis</a> is another popular, open-source connector supported by Spring Data Redis through the <code>org.springframework.data.redis.connection.jredis</code> package.</p>
</div>
<div class="paragraph">
<p>A typical JRedis configuration can looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"jredisConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jredis.JredisConnectionFactory"</span><span class="pln"> </span><span class="atn">p:host-name</span><span class="pun">=</span><span class="atv">"server"</span><span class="pln"> </span><span class="atn">p:port</span><span class="pun">=</span><span class="atv">"6379"</span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration is quite similar to Jedis, with one notable exception. By default, the <code>JedisConnectionFactory</code> pools connections. In order to use a connection pool with JRedis, configure the <code>JredisConnectionFactory</code> with an instance of <code>JredisPool</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"jredisConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jredis.JredisConnectionFactory"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;constructor-arg&gt;</span><span class="pln">
      </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jredis.DefaultJredisPool"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"localhost"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
        </span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"6379"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
      </span><span class="tag">&lt;/bean&gt;</span><span class="pln">
    </span><span class="tag">&lt;/constructor-arg&gt;</span><span class="pln">
  </span><span class="tag">&lt;/bean&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis:connectors:srp"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:srp"></a>5.3.4. Configuring SRP connector (Deprecated since 1.7)</h4>
<div class="paragraph">
<p><a href="https://github.com/spullara/redis-protocol">SRP</a> (an acronym for Sam’s Redis Protocol) is the third open-source connector supported by Spring Data Redis through the <code>org.springframework.data.redis.connection.srp</code> package.</p>
</div>
<div class="paragraph">
<p>By now, its configuration is probably easy to guess:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln"> </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"
  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"srpConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.srp.SrpConnectionFactory"</span><span class="pln"> </span><span class="atn">p:host-name</span><span class="pun">=</span><span class="atv">"server"</span><span class="pln"> </span><span class="atn">p:port</span><span class="pun">=</span><span class="atv">"6379"</span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Needless to say, the configuration is quite similar to that of the other connectors.</p>
</div>
</div>
<div class="sect3">
<h4 id="redis:connectors:lettuce"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:lettuce"></a>5.3.5. Configuring the Lettuce connector</h4>
<div class="paragraph">
<p><a href="https://github.com/mp911de/lettuce">Lettuce</a> is the fourth open-source connector supported by Spring Data Redis through the <code>org.springframework.data.redis.connection.lettuce</code> package.</p>
</div>
<div class="paragraph">
<p>Its configuration is probably easy to guess:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"lettuceConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory"</span><span class="pln"> </span><span class="atn">p:host-name</span><span class="pun">=</span><span class="atv">"server"</span><span class="pln"> </span><span class="atn">p:port</span><span class="pun">=</span><span class="atv">"6379"</span><span class="tag">/&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are also a few Lettuce-specific connection parameters that can be tweaked. By default, all <code>LettuceConnection</code> s created by the <code>LettuceConnectionFactory</code> share the same thread-safe native connection for all non-blocking and non-transactional operations. Set <code>shareNativeConnection</code> to false to use a dedicated connection each time. <code>LettuceConnectionFactory</code> can also be configured with a <code>LettucePool</code> to use for pooling blocking and transactional connections, or all connections if <code>shareNativeConnection</code> is set to false.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis:sentinel"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:sentinel"></a>5.4. Redis Sentinel Support</h3>
<div class="paragraph">
<p>For dealing with high-availability Redis, Spring Data Redis has support for <a href="http://redis.io/topics/sentinel">Redis Sentinel</a>, using <code>RedisSentinelConfiguration</code>, as shown in the following example:</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please note that currently only <a href="https://github.com/xetorthio/jedis">Jedis</a> and lettuce <a href="https://github.com/mp911de/lettuce">Lettuce</a> support Redis Sentinel.
</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="com">/**
 * jedis
 */</span><span class="pln">
</span><span class="lit">@Bean</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisConnectionFactory</span><span class="pln"> jedisConnectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="typ">RedisSentinelConfiguration</span><span class="pln"> sentinelConfig </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisSentinelConfiguration</span><span class="pun">()</span><span class="pln"> </span><span class="pun">.</span><span class="pln">master</span><span class="pun">(</span><span class="str">"mymaster"</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">sentinel</span><span class="pun">(</span><span class="str">"127.0.0.1"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">26379</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.</span><span class="pln">sentinel</span><span class="pun">(</span><span class="str">"127.0.0.1"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">26380</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JedisConnectionFactory</span><span class="pun">(</span><span class="pln">sentinelConfig</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">/**
 * lettuce
 */</span><span class="pln">
</span><span class="lit">@Bean</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisConnectionFactory</span><span class="pln"> lettuceConnectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="typ">RedisSentinelConfiguration</span><span class="pln"> sentinelConfig </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisSentinelConfiguration</span><span class="pun">().</span><span class="pln">master</span><span class="pun">(</span><span class="str">"mymaster"</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">sentinel</span><span class="pun">(</span><span class="str">"127.0.0.1"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">26379</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.</span><span class="pln">sentinel</span><span class="pun">(</span><span class="str">"127.0.0.1"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">26380</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LettuceConnectionFactory</span><span class="pun">(</span><span class="pln">sentinelConfig</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>RedisSentinelConfiguration</code> can also be defined with a <code>PropertySource</code>, which lets you set the following properties:</p>
</div>
<div class="ulist">
<div class="title">Configuration Properties</div>
<ul>
<li>
<p><code>spring.redis.sentinel.master</code>: name of the master node.</p>
</li>
<li>
<p><code>spring.redis.sentinel.nodes</code>: Comma delimited list of host:port pairs.</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Sometimes, direct interaction with one of the Sentinels is required. Using <code>RedisConnectionFactory.getSentinelConnection()</code> or <code>RedisConnection.getSentinelCommands()</code> gives you access to the first active Sentinel configured.</p>
</div>
</div>
<div class="sect2">
<h3 id="redis:template"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:template"></a>5.5. Working with Objects through RedisTemplate</h3>
<div class="paragraph">
<p>Most users are likely to use <code>RedisTemplate</code> and its coresponding package, <code>org.springframework.data.redis.core</code>. The template is, in fact, the central class of the Redis module, due to its rich feature set. The template offers a high-level abstraction for Redis interactions. While <code>RedisConnection</code> offers low-level methods that accept and return binary values (<code>byte</code> arrays), the template takes care of serialization and connection management, freeing the user from dealing with such details.</p>
</div>
<div class="paragraph">
<p>Moreover, the template provides operations views (following the grouping from the Redis command <a href="http://redis.io/commands">reference</a>) that offer rich, generified interfaces for working against a certain type or certain key (through the <code>KeyBound</code> interfaces) as described in the following table:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 1. Operational views</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Interface</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><em>Key Type Operations</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GeoOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis geospatial operations, such as <code>GEOADD</code>, <code>GEORADIUS</code>,…​</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HashOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis hash operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HyperLogLogOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis HyperLogLog operations, such as <code>PFADD</code>, <code>PFCOUNT</code>,…​</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ListOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis list operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SetOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis set operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValueOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis string (or value) operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ZSetOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis zset (or sorted set) operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HashOperations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis hash operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HyperLogLogOperations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis HyperLogLog operations like (pfadd, pfcount,…​)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GeoOperations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis geospatial operations like <code>GEOADD</code>, <code>GEORADIUS</code>,…​)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><em>Key Bound Operations</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundGeoOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis key bound geospatial operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundHashOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis hash key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundKeyOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundListOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis list key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundSetOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis set key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundValueOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis string (or value) key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BoundZSetOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis zset (or sorted set) key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BoundHashOperations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis hash key bound operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BoundGeoOperations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redis key bound geospatial operations.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Once configured, the template is thread-safe and can be reused across multiple instances.</p>
</div>
<div class="paragraph">
<p><code>RedisTemplate</code> uses a Java-based serializer for most of its operations. This means that any object written or read by the template is serialized and deserialized through Java. You can change the serialization mechanism on the template, and the Redis module offers several implementations, which are available in the <code>org.springframework.data.redis.serializer</code> package. See <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:serializer">Serializers</a> for more information. You can also set any of the serializers to null and use RedisTemplate with raw byte arrays by setting the <code>enableDefaultSerializer</code> property to <code>false</code>. Note that the template requires all keys to be non-null. However, values can be null as long as the underlying serializer accepts them. Read the Javadoc of each serializer for more information.</p>
</div>
<div class="paragraph">
<p>For cases where you need a certain template view, declare the view as a dependency and inject the template. The container automatically performs the conversion, eliminating the <code>opsFor[X]</code> calls, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"jedisConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span><span class="pln"> </span><span class="atn">p:use-pool</span><span class="pun">=</span><span class="atv">"true"</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="com">&lt;!-- redis template definition --&gt;</span><span class="pln">
  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"redisTemplate"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.core.RedisTemplate"</span><span class="pln"> </span><span class="atn">p:connection-factory-ref</span><span class="pun">=</span><span class="atv">"jedisConnectionFactory"</span><span class="tag">/&gt;</span><span class="pln">
  ...

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Example</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">// inject the actual template</span><span class="pln">
  </span><span class="lit">@Autowired</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">RedisTemplate</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> template</span><span class="pun">;</span><span class="pln">

  </span><span class="com">// inject the template as ListOperations</span><span class="pln">
  </span><span class="lit">@Resource</span><span class="pun">(</span><span class="pln">name</span><span class="pun">=</span><span class="str">"redisTemplate"</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">ListOperations</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> listOps</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> addLink</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> userId</span><span class="pun">,</span><span class="pln"> URL url</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    listOps</span><span class="pun">.</span><span class="pln">leftPush</span><span class="pun">(</span><span class="pln">userId</span><span class="pun">,</span><span class="pln"> url</span><span class="pun">.</span><span class="pln">toExternalForm</span><span class="pun">());</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis:string"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:string"></a>5.6. String-focused Convenience Classes</h3>
<div class="paragraph">
<p>Since it is quite common for the keys and values stored in Redis to be <code>java.lang.String</code>, the Redis modules provides two extensions to <code>RedisConnection</code> and <code>RedisTemplate</code>, respectively the <code>StringRedisConnection</code> (and its <code>DefaultStringRedisConnection</code> implementation) and <code>StringRedisTemplate</code> as a convenient one-stop solution for intensive String operations. In addition to being bound to <code>String</code> keys, the template and the connection use the <code>StringRedisSerializer</code> underneath, which means the stored keys and values are human-readable (assuming the same encoding is used both in Redis and your code). The following listings show an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"jedisConnectionFactory"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span><span class="pln"> </span><span class="atn">p:use-pool</span><span class="pun">=</span><span class="atv">"true"</span><span class="tag">/&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"stringRedisTemplate"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.core.StringRedisTemplate"</span><span class="pln"> </span><span class="atn">p:connection-factory-ref</span><span class="pun">=</span><span class="atv">"jedisConnectionFactory"</span><span class="tag">/&gt;</span><span class="pln">
  ...
</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Example</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Autowired</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">StringRedisTemplate</span><span class="pln"> redisTemplate</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> addLink</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> userId</span><span class="pun">,</span><span class="pln"> URL url</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    redisTemplate</span><span class="pun">.</span><span class="pln">opsForList</span><span class="pun">().</span><span class="pln">leftPush</span><span class="pun">(</span><span class="pln">userId</span><span class="pun">,</span><span class="pln"> url</span><span class="pun">.</span><span class="pln">toExternalForm</span><span class="pun">());</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As with the other Spring templates, <code>RedisTemplate</code> and <code>StringRedisTemplate</code> let you talk directly to Redis through the <code>RedisCallback</code> interface. This feature gives complete control to you, as it talks directly to the <code>RedisConnection</code>. Note that the callback receives an instance of <code>StringRedisConnection</code> when a <code>StringRedisTemplate</code> is used. The following example shows how to use the <code>RedisCallback</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> useCallback</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  redisTemplate</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisCallback</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Object</span><span class="pln"> doInRedis</span><span class="pun">(</span><span class="typ">RedisConnection</span><span class="pln"> connection</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">DataAccessException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="typ">Long</span><span class="pln"> size </span><span class="pun">=</span><span class="pln"> connection</span><span class="pun">.</span><span class="pln">dbSize</span><span class="pun">();</span><span class="pln">
      </span><span class="com">// Can cast to StringRedisConnection if using a StringRedisTemplate</span><span class="pln">
      </span><span class="pun">((</span><span class="typ">StringRedisConnection</span><span class="pun">)</span><span class="pln">connection</span><span class="pun">).</span><span class="pln">set</span><span class="pun">(</span><span class="str">"key"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"value"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
   </span><span class="pun">});</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis:serializer"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:serializer"></a>5.7. Serializers</h3>
<div class="paragraph">
<p>From the framework perspective, the data stored in Redis is only bytes. While Redis itself supports various types, for the most part, these refer to the way the data is stored rather than what it represents. It is up to the user to decide whether the information gets translated into strings or any other objects.</p>
</div>
<div class="paragraph">
<p>In Spring Data, the conversion between the user (custom) types and raw data (and vice-versa) is handled Redis in the <code>org.springframework.data.redis.serializer</code> package.</p>
</div>
<div class="paragraph">
<p>This package contains two types of serializers that, as the name implies, take care of the serialization process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Two-way serializers based on <code>RedisSerializer</code>.</p>
</li>
<li>
<p>Element readers and writers that use <code>RedisElementReader</code> and <code>RedisElementWriter</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The main difference between these variants is that <code>RedisSerializer</code> primarily serializes to <code>byte[]</code> while readers and writers use <code>ByteBuffer</code>.</p>
</div>
<div class="paragraph">
<p>Multiple implementations are available (including two that have been already mentioned in this documentation):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JdkSerializationRedisSerializer</code>, which is used by default for <code>RedisCache</code> and <code>RedisTemplate</code>.</p>
</li>
<li>
<p>the <code>StringRedisSerializer</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However one can use <code>OxmSerializer</code> for Object/XML mapping through Spring <a href="https://docs.spring.io/spring/docs/4.3.17.RELEASE/spring-framework-reference/data-access.html#oxm">OXM</a> support or <code>Jackson2JsonRedisSerializer</code> or <code>GenericJackson2JsonRedisSerializer</code> for storing data in <a href="https://en.wikipedia.org/wiki/JSON">JSON</a> format.</p>
</div>
<div class="paragraph">
<p>Do note that the storage format is not limited only to values. It can be used for keys, values, or hashes without any restrictions.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, <code>RedisCache</code> and <code>RedisTemplate</code> are configured to use Java native serialization. Java native serialization is known for allowing remote code execution caused by payloads that exploit vulnerable libraries and classes injecting unverified bytecode. Manipulated input could lead to unwanted code execution in the application during the deserialization step. As a consequence, do not use serialization in untrusted environments. In general, we strongly recommend any other message format (such as JSON) instead.</p>
</div>
<div class="paragraph">
<p>If you are concerned about security vulnerabilities due to Java serialization, consider the general-purpose serialization filter mechanism at the core JVM level, originally developed for JDK 9 but backported to JDK 8, 7, and 6:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://blogs.oracle.com/java-platform-group/entry/incoming_filter_serialization_data_a">Filter Incoming Serialization Data</a>.</p>
</li>
<li>
<p><a href="http://openjdk.java.net/jeps/290">JEP 290</a>.</p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Deserialization_of_untrusted_data">OWASP: Deserialization of untrusted data</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="redis.hashmappers.root"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.hashmappers.root"></a>5.8. Hash mapping</h3>
<div class="paragraph">
<p>Data can be stored by using various data structures within Redis. <code>Jackson2JsonRedisSerializer</code> can convert objects in <a href="https://en.wikipedia.org/wiki/JSON">JSON</a> format. Ideally, JSON can be stored as a value by using plain keys. You can achieve a more sophisticated mapping of structured objects by using Redis hashes. Spring Data Redis offers various strategies for mapping data to hashes (depending on the use case):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Direct mapping, by using <code>HashOperations</code> and a <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:serializer">serializer</a></p>
</li>
<li>
<p>Using <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories">Redis Repositories</a></p>
</li>
<li>
<p>Using <code>HashMapper</code> and <code>HashOperations</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_hash_mappers"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_hash_mappers"></a>5.8.1. Hash Mappers</h4>
<div class="paragraph">
<p>Hash mappers are converters of map objects to a <code>Map&lt;K, V&gt;</code> and back. <code>HashMapper</code> is intended for using with Redis Hashes.</p>
</div>
<div class="paragraph">
<p>Multiple implementations are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BeanUtilsHashMapper</code> using Spring’s <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/BeanUtils.html">BeanUtils</a>.</p>
</li>
<li>
<p><code>ObjectHashMapper</code> using <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.mapping">Object-to-Hash Mapping</a>.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.hashmappers.jackson2"><code>Jackson2HashMapper</code></a> using <a href="https://github.com/FasterXML/jackson">FasterXML Jackson</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example shows one way to implement hash mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> firstname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> lastname</span><span class="pun">;</span><span class="pln">

  </span><span class="com">// …</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HashMapping</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Autowired</span><span class="pln">
  </span><span class="typ">HashOperations</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> hashOperations</span><span class="pun">;</span><span class="pln">

  </span><span class="typ">HashMapper</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> mapper </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ObjectHashMapper</span><span class="pun">();</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> writeHash</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> person</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> mappedHash </span><span class="pun">=</span><span class="pln"> mapper</span><span class="pun">.</span><span class="pln">toHash</span><span class="pun">(</span><span class="pln">person</span><span class="pun">);</span><span class="pln">
    hashOperations</span><span class="pun">.</span><span class="pln">putAll</span><span class="pun">(</span><span class="pln">key</span><span class="pun">,</span><span class="pln"> mappedHash</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> loadHash</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> key</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> loadedHash </span><span class="pun">=</span><span class="pln"> hashOperations</span><span class="pun">.</span><span class="pln">entries</span><span class="pun">(</span><span class="str">"key"</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Person</span><span class="pun">)</span><span class="pln"> mapper</span><span class="pun">.</span><span class="pln">fromHash</span><span class="pun">(</span><span class="pln">loadedHash</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis.hashmappers.jackson2"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.hashmappers.jackson2"></a>5.8.2. Jackson2HashMapper</h4>
<div class="paragraph">
<p><code>Jackson2HashMapper</code> provides Redis Hash mapping for domain objects by using <a href="https://github.com/FasterXML/jackson">FasterXML Jackson</a>.
<code>Jackson2HashMapper</code> can map top-level properties as Hash field names and, optionally, flatten the structure.
Simple types map to simple values. Complex types (nested objects, collections, maps, and so on) are represented as nested JSON.</p>
</div>
<div class="paragraph">
<p>Flattening creates individual hash entries for all nested properties and resolves complex types into simple types, as far as possible.</p>
</div>
<div class="paragraph">
<p>Consider the following class and the data structure it contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> firstname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> lastname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">Address</span><span class="pln"> address</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Address</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> city</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> country</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table shows how the data in the preceding class would appear in normal mapping:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 2. Normal Mapping</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hash Field</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Jon</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Snow</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{ "city" : "Castle Black", "country" : "The North" }</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following table shows how the data in the preceding class would appear in flat mapping:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 3. Flat Mapping</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hash Field</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Jon</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Snow</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">address.city</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Castle Black</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">address.country</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>The North</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Flattening requires all property names to not interfere with the JSON path. Using dots or brackets in map keys or as property names is not supported when you use flattening. The resulting hash cannot be mapped back into an Object.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pubsub"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#pubsub"></a>5.9. Redis Messaging (Pub/Sub)</h3>
<div class="paragraph">
<p>Spring Data provides dedicated messaging integration for Redis, similar in functionality and naming to the JMS integration in Spring Framework.</p>
</div>
<div class="paragraph">
<p>Redis messaging can be roughly divided into two areas of functionality:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Publication or production of messages</p>
</li>
<li>
<p>Subscription or consumption of messages</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is an example of the pattern often called Publish/Subscribe (Pub/Sub for short). The <code>RedisTemplate</code> class is used for message production. For asynchronous reception similar to Java EE’s message-driven bean style, Spring Data provides a dedicated message listener container that is used to create Message-Driven POJOs (MDPs) and, for synchronous reception, the <code>RedisConnection</code> contract.</p>
</div>
<div class="paragraph">
<p>The <code>org.springframework.data.redis.connection</code> and <code>org.springframework.data.redis.listener</code> packages provide the core functionality for Redis messaging.</p>
</div>
<div class="sect3">
<h4 id="redis:pubsub:publish"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:publish"></a>5.9.1. Publishing (Sending Messages)</h4>
<div class="paragraph">
<p>To publish a message, you can use, as with the other operations, either the low-level <code>RedisConnection</code> or the high-level <code>RedisTemplate</code>. Both entities offer the <code>publish</code> method, which accepts the message and the destination channel as arguments. While <code>RedisConnection</code> requires raw data (array of bytes), the <code>RedisTemplate</code> lets arbitrary objects be passed in as messages, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="com">// send message through connection RedisConnection con = ...</span><span class="pln">
</span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> msg </span><span class="pun">=</span><span class="pln"> </span><span class="pun">...</span><span class="pln">
</span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> channel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">...</span><span class="pln">
con</span><span class="pun">.</span><span class="pln">publish</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">,</span><span class="pln"> channel</span><span class="pun">);</span><span class="pln"> </span><span class="com">// send message through RedisTemplate</span><span class="pln">
</span><span class="typ">RedisTemplate</span><span class="pln"> template </span><span class="pun">=</span><span class="pln"> </span><span class="pun">...</span><span class="pln">
template</span><span class="pun">.</span><span class="pln">convertAndSend</span><span class="pun">(</span><span class="str">"hello!"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"world"</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis:pubsub:subscribe"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:subscribe"></a>5.9.2. Subscribing (Receiving Messages)</h4>
<div class="paragraph">
<p>On the receiving side, one can subscribe to one or multiple channels either by naming them directly or by using pattern matching. The latter approach is quite useful, as it not only lets multiple subscriptions be created with one command but can also listen on channels not yet created at subscription time (as long as they match the pattern).</p>
</div>
<div class="paragraph">
<p>At the low-level, <code>RedisConnection</code> offers the <code>subscribe</code> and <code>pSubscribe</code> methods that map the Redis commands for subscribing by channel or by pattern, respectively. Note that multiple channels or patterns can be used as arguments. To change the subscription of a connection or query whether it is listening, <code>RedisConnection</code> provides the <code>getSubscription</code> and <code>isSubscribed</code> methods.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Subscription commands in Spring Data Redis are blocking. That is, calling subscribe on a connection causes the current thread to block as it starts waiting for messages. The thread is released only if the subscription is canceled, which happens when another thread invokes <code>unsubscribe</code> or <code>pUnsubscribe</code> on the <strong>same</strong> connection. See “<a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:subscribe:containers">Message Listener Containers</a>” (later in this document) for a solution to this problem.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>As mentioned earlier, once subscribed, a connection starts waiting for messages. Only commands that add new subscriptions, modify existing subscriptions, and cancel existing subscriptions are allowed. Invoking anything other than <code>subscribe</code>, <code>pSubscribe</code>, <code>unsubscribe</code>, or <code>pUnsubscribe</code> throws an exception.</p>
</div>
<div class="paragraph">
<p>In order to subscribe to messages, one needs to implement the <code>MessageListener</code> callback. Each time a new message arrives, the callback gets invoked and the user code gets run by the <code>onMessage</code> method. The interface gives access not only to the actual message but also to the channel it has been received through and the pattern (if any) used by the subscription to match the channel. This information lets the callee differentiate between various messages not just by content but also examining additional details.</p>
</div>
<div class="sect4">
<h5 id="redis:pubsub:subscribe:containers"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:subscribe:containers"></a>Message Listener Containers</h5>
<div class="paragraph">
<p>Due to its blocking nature, low-level subscription is not attractive, as it requires connection and thread management for every single listener. To alleviate this problem, Spring Data offers <code>RedisMessageListenerContainer</code>, which does all the heavy lifting. If you are familiar with EJB and JMS, you should find the concepts familiar, as it is designed to be as close as possible to the support in Spring Framework and its message-driven POJOs (MDPs).</p>
</div>
<div class="paragraph">
<p><code>RedisMessageListenerContainer</code> acts as a message listener container. It is used to receive messages from a Redis channel and drive the <code>MessageListener</code> instances that are injected into it. The listener container is responsible for all threading of message reception and dispatches into the listener for processing. A message listener container is the intermediary between an MDP and a messaging provider and takes care of registering to receive messages, resource acquisition and release, exception conversion, and the like. This lets you as an application developer write the (possibly complex) business logic associated with receiving a message (and reacting to it) and delegates boilerplate Redis infrastructure concerns to the framework.</p>
</div>
<div class="paragraph">
<p>Furthermore, to minimize the application footprint, <code>RedisMessageListenerContainer</code> lets one connection and one thread be shared by multiple listeners even though they do not share a subscription. Thus, no matter how many listeners or channels an application tracks, the runtime cost remains the same throughout its lifetime. Moreover, the container allows runtime configuration changes so that you can add or remove listeners while an application is running without the need for a restart. Additionally, the container uses a lazy subscription approach, using a <code>RedisConnection</code> only when needed. If all the listeners are unsubscribed, cleanup is automatically performed, and the thread is released.</p>
</div>
<div class="paragraph">
<p>To help with the asynchronous nature of messages, the container requires a <code>java.util.concurrent.Executor</code> (or Spring’s <code>TaskExecutor</code>) for dispatching the messages. Depending on the load, the number of listeners, or the runtime environment, you should change or tweak the executor to better serve your needs. In particular, in managed environments (such as app servers), it is highly recommended to pick a proper <code>TaskExecutor</code> to take advantage of its runtime.</p>
</div>
</div>
<div class="sect4">
<h5 id="redis:pubsub:subscribe:adapter"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:pubsub:subscribe:adapter"></a>The MessageListenerAdapter</h5>
<div class="paragraph">
<p>The <code>MessageListenerAdapter</code> class is the final component in Spring’s asynchronous messaging support. In a nutshell, it lets you expose almost <strong>any</strong> class as a MDP (though there are some constraints).</p>
</div>
<div class="paragraph">
<p>Consider the following interface definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">MessageDelegate</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">void</span><span class="pln"> handleMessage</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> message</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">void</span><span class="pln"> handleMessage</span><span class="pun">(</span><span class="typ">Map</span><span class="pln"> message</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> handleMessage</span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> message</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">void</span><span class="pln"> handleMessage</span><span class="pun">(</span><span class="typ">Serializable</span><span class="pln"> message</span><span class="pun">);</span><span class="pln">
  </span><span class="com">// pass the channel/pattern as well</span><span class="pln">
  </span><span class="kwd">void</span><span class="pln"> handleMessage</span><span class="pun">(</span><span class="typ">Serializable</span><span class="pln"> message</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> channel</span><span class="pun">);</span><span class="pln">
 </span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that, although the interface does not extend the <code>MessageListener</code> interface, it can still be used as a MDP by using the <code>MessageListenerAdapter</code> class. Notice also how the various message handling methods are strongly typed according to the <strong>contents</strong> of the various <code>Message</code> types that they can receive and handle. In addition, the channel or pattern to which a message is sent can be passed in to the method as the second argument of type <code>String</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultMessageDelegate</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">MessageDelegate</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// implementation elided for clarity...</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice how the above implementation of the <code>MessageDelegate</code> interface (the above <code>DefaultMessageDelegate</code> class) has <strong>no</strong> Redis dependencies at all. It truly is a POJO that we make into an MDP with the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
 </span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
   </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
   </span><span class="atn">xmlns:redis</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/redis"</span><span class="pln">
   </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
   http://www.springframework.org/schema/redis http://www.springframework.org/schema/redis/spring-redis.xsd"</span><span class="tag">&gt;</span><span class="pln">

</span><span class="com">&lt;!-- the default ConnectionFactory --&gt;</span><span class="pln">
</span><span class="tag">&lt;redis:listener-container&gt;</span><span class="pln">
  </span><span class="com">&lt;!-- the method attribute can be skipped as the default method name is "handleMessage" --&gt;</span><span class="pln">
  </span><span class="tag">&lt;redis:listener</span><span class="pln"> </span><span class="atn">ref</span><span class="pun">=</span><span class="atv">"listener"</span><span class="pln"> </span><span class="atn">method</span><span class="pun">=</span><span class="atv">"handleMessage"</span><span class="pln"> </span><span class="atn">topic</span><span class="pun">=</span><span class="atv">"chatroom"</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/redis:listener-container&gt;</span><span class="pln">

</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"listener"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"redisexample.DefaultMessageDelegate"</span><span class="tag">/&gt;</span><span class="pln">
 ...
</span><span class="tag">&lt;beans&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The listener topic can be either a channel (for example, <code>topic="chatroom"</code>) or a pattern (for example, <code>topic="*room"</code>)
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The preceding example uses the Redis namespace to declare the message listener container and automatically register the POJOs as listeners. The full blown beans definition follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"messageListener"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.listener.adapter.MessageListenerAdapter"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;constructor-arg&gt;</span><span class="pln">
    </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"redisexample.DefaultMessageDelegate"</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/constructor-arg&gt;</span><span class="pln">
</span><span class="tag">&lt;/bean&gt;</span><span class="pln">

</span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"redisContainer"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.listener.RedisMessageListenerContainer"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;property</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"connectionFactory"</span><span class="pln"> </span><span class="atn">ref</span><span class="pun">=</span><span class="atv">"connectionFactory"</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;property</span><span class="pln"> </span><span class="atn">name</span><span class="pun">=</span><span class="atv">"messageListeners"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;map&gt;</span><span class="pln">
      </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">key-ref</span><span class="pun">=</span><span class="atv">"messageListener"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.listener.ChannelTopic"</span><span class="tag">&gt;</span><span class="pln">
          </span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"chatroom"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;/bean&gt;</span><span class="pln">
      </span><span class="tag">&lt;/entry&gt;</span><span class="pln">
    </span><span class="tag">&lt;/map&gt;</span><span class="pln">
  </span><span class="tag">&lt;/property&gt;</span><span class="pln">
</span><span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Each time a message is received, the adapter automatically and transparently performs translation (using the configured <code>RedisSerializer</code>) between the low-level format and the required object type. Any exception caused by the method invocation is caught and handled by the container (by default, exceptions get logged).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tx"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#tx"></a>5.10. Redis Transactions</h3>
<div class="paragraph">
<p>Redis provides support for <a href="http://redis.io/topics/transactions">transactions</a> through the <code>multi</code>, <code>exec</code>, and <code>discard</code> commands. These operations are available on <code>RedisTemplate</code>. However, <code>RedisTemplate</code> is not guaranteed to execute all operations in the transaction with the same connection.</p>
</div>
<div class="paragraph">
<p>Spring Data Redis provides the <code>SessionCallback</code> interface for use when multiple operations need to be performed with the same <code>connection</code>, such as when using Redis transactions. The following example uses the <code>multi</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="com">//execute a transaction</span><span class="pln">
</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> txResults </span><span class="pun">=</span><span class="pln"> redisTemplate</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SessionCallback</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">&gt;&gt;()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> execute</span><span class="pun">(</span><span class="typ">RedisOperations</span><span class="pln"> operations</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">DataAccessException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    operations</span><span class="pun">.</span><span class="pln">multi</span><span class="pun">();</span><span class="pln">
    operations</span><span class="pun">.</span><span class="pln">opsForSet</span><span class="pun">().</span><span class="pln">add</span><span class="pun">(</span><span class="str">"key"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"value1"</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// This will contain the results of all operations in the transaction</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> operations</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">});</span><span class="pln">
</span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Number of items added to set: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> txResults</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>RedisTemplate</code> uses its value, hash key, and hash value serializers to deserialize all results of <code>exec</code> before returning. There is an additional <code>exec</code> method that lets you pass a custom serializer for transaction results.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of version 1.1, an important change has been made to the <code>exec</code> methods of <code>RedisConnection</code> and <code>RedisTemplate</code>. Previously, these methods returned the results of transactions directly from the connectors. This means that the data types often differed from those returned from the methods of <code>RedisConnection</code>. For example, <code>zAdd</code> returns a boolean indicating whether the element has been added to the sorted set. Most connectors return this value as a long, and Spring Data Redis performs the conversion. Another common difference is that most connectors return a status reply (usually the string, <code>OK</code>) for operations such as <code>set</code>. These replies are typically discarded by Spring Data Redis. Prior to 1.1, these conversions were not performed on the results of <code>exec</code>. Also, results were not deserialized in <code>RedisTemplate</code>, so they often included raw byte arrays. If this change breaks your application, set <code>convertPipelineAndTxResults</code> to <code>false</code> on your <code>RedisConnectionFactory</code> to disable this behavior.
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="tx.spring"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#tx.spring"></a>5.10.1. @Transactional Support</h4>
<div class="paragraph">
<p>By default, transaction Support is disabled and has to be explicitly enabled for each <code>RedisTemplate</code> in use by setting <code>setEnableTransactionSupport(true)</code>. Doing so forces binding the current <code>RedisConnection</code> to the current <code>Thread</code> that is triggering <code>MULTI</code>. If the transaction finishes without errors, <code>EXEC</code> is called. Otherwise <code>DISCARD</code> is called. Once in <code>MULTI</code>, <code>RedisConnection</code> queues write operations. All <code>readonly</code> operations, such as <code>KEYS</code>, are piped to a fresh (non-thread-bound) <code>RedisConnection</code>.</p>
</div>
<div class="paragraph">
<p>The following example shows how to configure transaction management:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Configuration enabling Transaction Management</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableTransactionManagement</span><span class="pln">                                 </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">RedisTxContextConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">StringRedisTemplate</span><span class="pln"> redisTemplate</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="typ">StringRedisTemplate</span><span class="pln"> template </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">StringRedisTemplate</span><span class="pun">(</span><span class="pln">redisConnectionFactory</span><span class="pun">());</span><span class="pln">
    </span><span class="com">// explicitly enable transaction support</span><span class="pln">
    template</span><span class="pun">.</span><span class="pln">setEnableTransactionSupport</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span><span class="pln">              </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> template</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisConnectionFactory</span><span class="pln"> redisConnectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="com">// jedis || Lettuce || srp || ...</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">PlatformTransactionManager</span><span class="pln"> transactionManager</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">SQLException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DataSourceTransactionManager</span><span class="pun">(</span><span class="pln">dataSource</span><span class="pun">());</span><span class="pln">   </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">DataSource</span><span class="pln"> dataSource</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">SQLException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="com">// ...</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configures a Spring Context to enable <a href="https://docs.spring.io/spring/docs/4.3.17.RELEASE/spring-framework-reference/data-access.html#transaction-declarative">declarative transaction management</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Configures <code>RedisTemplate</code> to participate in transactions by binding connections to the current thread.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Transaction management requires a <code>PlatformTransactionManager</code>. Spring Data Redis does not ship with a <code>PlatformTransactionManager</code> implementation. Assuming your application uses JDBC, Spring Data Redis can participate in transactions by using existing transaction managers.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>The following examples each demonstrate a usage constraint:</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Usage Constraints</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="com">// must be performed on thread-bound connection</span><span class="pln">
template</span><span class="pun">.</span><span class="pln">opsForValue</span><span class="pun">().</span><span class="pln">set</span><span class="pun">(</span><span class="str">"thing1"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"thing2"</span><span class="pun">);</span><span class="pln">

</span><span class="com">// read operation must be executed on a free (not transaction-aware) connection</span><span class="pln">
template</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">(</span><span class="str">"*"</span><span class="pun">);</span><span class="pln">

</span><span class="com">// returns null as values set within a transaction are not visible</span><span class="pln">
template</span><span class="pun">.</span><span class="pln">opsForValue</span><span class="pun">().</span><span class="pln">get</span><span class="pun">(</span><span class="str">"thing1"</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pipeline"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#pipeline"></a>5.11. Pipelining</h3>
<div class="paragraph">
<p>Redis provides support for <a href="http://redis.io/topics/pipelining">pipelining</a>, which involves sending multiple commands to the server without waiting for the replies and then reading the replies in a single step. Pipelining can improve performance when you need to send several commands in a row, such as adding many elements to the same List.</p>
</div>
<div class="paragraph">
<p>Spring Data Redis provides several <code>RedisTemplate</code> methods for executing commands in a pipeline. If you do not care about the results of the pipelined operations, you can use the standard <code>execute</code> method, passing <code>true</code> for the <code>pipeline</code> argument. The <code>executePipelined</code> methods run the provided <code>RedisCallback</code> or <code>SessionCallback</code> in a pipeline and return the results, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="com">//pop a specified number of items from a queue</span><span class="pln">
</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> results </span><span class="pun">=</span><span class="pln"> stringRedisTemplate</span><span class="pun">.</span><span class="pln">executePipelined</span><span class="pun">(</span><span class="pln">
  </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisCallback</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">&gt;()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Object</span><span class="pln"> doInRedis</span><span class="pun">(</span><span class="typ">RedisConnection</span><span class="pln"> connection</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">DataAccessException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="typ">StringRedisConnection</span><span class="pln"> stringRedisConn </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">StringRedisConnection</span><span class="pun">)</span><span class="pln">connection</span><span class="pun">;</span><span class="pln">
      </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln"> batchSize</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        stringRedisConn</span><span class="pun">.</span><span class="pln">rPop</span><span class="pun">(</span><span class="str">"myqueue"</span><span class="pun">);</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">});</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding example runs a bulk right pop of items from a queue in a pipeline. The <code>results</code> <code>List</code> contains all of the popped items. <code>RedisTemplate</code> uses its value, hash key, and hash value serializers to deserialize all results before returning, so the returned items in the preceding example are Strings. There are additional <code>executePipelined</code> methods that let you pass a custom serializer for pipelined results.</p>
</div>
<div class="paragraph">
<p>Note that the value returned from the <code>RedisCallback</code> is required to be null, as this value is discarded in favor of returning the results of the pipelined commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of version 1.1, an important change has been made to the <code>exec</code> methods of <code>RedisConnection</code> and <code>RedisTemplate</code>. Previously, these methods returned the results of transactions directly from the connectors. This means that the data types often differed from those returned from the methods of <code>RedisConnection</code>. For example, <code>zAdd</code> returns a boolean indicating whether the element has been added to the sorted set. Most connectors return this value as a long, and Spring Data Redis performs the conversion. Another common difference is that most connectors return a status reply (usually the string, <code>OK</code>) for operations such as <code>set</code>. These replies are typically discarded by Spring Data Redis. Prior to 1.1, these conversions were not performed on the results of <code>exec</code>. Also, results were not deserialized in <code>RedisTemplate</code>, so they often included raw byte arrays. If this change breaks your application, set <code>convertPipelineAndTxResults</code> to <code>false</code> on your <code>RedisConnectionFactory</code> to disable this behavior.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="scripting"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#scripting"></a>5.12. Redis Scripting</h3>
<div class="paragraph">
<p>Redis versions 2.6 and higher provide support for execution of Lua scripts through the <a href="http://redis.io/commands/eval">eval</a> and <a href="http://redis.io/commands/evalsha">evalsha</a> commands. Spring Data Redis provides a high-level abstraction for script execution that handles serialization and automatically uses the Redis script cache.</p>
</div>
<div class="paragraph">
<p>Scripts can be run by calling the <code>execute</code> methods of <code>RedisTemplate</code>. It uses a configurable <code>ScriptExecutor</code> to run the provided script. By default, the <code>ScriptExecutor</code> takes care of serializing the provided keys and arguments and deserializing the script result. This is done through the key and value serializers of the template. There is an additional overload that lets you pass custom serializers for the script arguments and the result.</p>
</div>
<div class="paragraph">
<p>The default <code>ScriptExecutor</code> optimizes performance by retrieving the SHA1 of the script and attempting first to run <code>evalsha</code>, falling back to <code>eval</code> if the script is not yet present in the Redis script cache.</p>
</div>
<div class="paragraph">
<p>The following example runs a common “check-and-set” scenario by using a Lua script. This is an ideal use case for a Redis script, as it requires that running a set of commands atomically, and the behavior of one command is influenced by the result of another.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Bean</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisScript</span><span class="pun">&lt;</span><span class="typ">Boolean</span><span class="pun">&gt;</span><span class="pln"> script</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="typ">DefaultRedisScript</span><span class="pun">&lt;</span><span class="typ">Boolean</span><span class="pun">&gt;</span><span class="pln"> redisScript </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DefaultRedisScript</span><span class="pun">&lt;</span><span class="typ">Boolean</span><span class="pun">&gt;();</span><span class="pln">
  redisScript</span><span class="pun">.</span><span class="pln">setScriptSource</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ResourceScriptSource</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ClassPathResource</span><span class="pun">(</span><span class="str">"META-INF/scripts/checkandset.lua"</span><span class="pun">)));</span><span class="pln">
  redisScript</span><span class="pun">.</span><span class="pln">setResultType</span><span class="pun">(</span><span class="typ">Boolean</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Example</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="lit">@Autowired</span><span class="pln">
  </span><span class="typ">RedisScript</span><span class="pun">&lt;</span><span class="typ">Boolean</span><span class="pun">&gt;</span><span class="pln"> script</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> checkAndSet</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> expectedValue</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> newValue</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> redisTemplate</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">script</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Collections</span><span class="pun">.</span><span class="pln">singletonList</span><span class="pun">(</span><span class="str">"key"</span><span class="pun">),</span><span class="pln"> expectedValue</span><span class="pun">,</span><span class="pln"> newValue</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-lua" data-lang="lua"><span class="pun">--</span><span class="pln"> checkandset</span><span class="pun">.</span><span class="pln">lua
</span><span class="kwd">local</span><span class="pln"> current </span><span class="pun">=</span><span class="pln"> redis</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="str">'GET'</span><span class="pun">,</span><span class="pln"> KEYS</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> current </span><span class="pun">==</span><span class="pln"> ARGV</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln">
  </span><span class="kwd">then</span><span class="pln"> redis</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="str">'SET'</span><span class="pun">,</span><span class="pln"> KEYS</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> ARGV</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
</span><span class="kwd">end</span><span class="pln">
</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding code configures a <code>RedisScript</code> pointing to a file called <code>checkandset.lua</code>, which is expected to return a boolean value. The script <code>resultType</code> should be one of <code>Long</code>, <code>Boolean</code>, <code>List</code>, or a deserialized value type. It can also be <code>null</code> if the script returns a throw-away status (specifically, <code>OK</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is ideal to configure a single instance of <code>DefaultRedisScript</code> in your application context to avoid re-calculation of the script’s SHA1 on every script execution.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The <code>checkAndSet</code> method above then runs the scripts. Scripts can be run within a <code>SessionCallback</code> as part of a transaction or pipeline. See “<a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#tx">Redis Transactions</a>” and “<a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#pipeline">Pipelining</a>” for more information.</p>
</div>
<div class="paragraph">
<p>The scripting support provided by Spring Data Redis also lets you schedule Redis scripts for periodic execution by using the Spring Task and Scheduler abstractions. See the <a href="https://projects.spring.io/spring-framework/">Spring Framework</a> documentation for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="redis:support"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:support"></a>5.13. Support Classes</h3>
<div class="paragraph">
<p>Package <code>org.springframework.data.redis.support</code> offers various reusable components that rely on Redis as a backing store. Currently, the package contains various JDK-based interface implementations on top of Redis, such as <a href="http://download.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/package-summary.html">atomic</a> counters and JDK <a href="http://download.oracle.com/javase/6/docs/api/java/util/Collection.html">Collections</a>.</p>
</div>
<div class="paragraph">
<p>The atomic counters make it easy to wrap Redis key incrementation while the collections allow easy management of Redis keys with minimal storage exposure or API leakage. In particular, the <code>RedisSet</code> and <code>RedisZSet</code> interfaces offer easy access to the set operations supported by Redis, such as <code>intersection</code> and <code>union</code>. <code>RedisList</code> implements the <code>List</code>, <code>Queue</code>, and <code>Deque</code> contracts (and their equivalent blocking siblings) on top of Redis, exposing the storage as a FIFO (First-In-First-Out), LIFO (Last-In-First-Out) or capped collection with minimal configuration. The following example shows the configuration for a bean that uses a <code>RedisList</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="pun">&lt;?</span><span class="pln">xml version</span><span class="pun">=</span><span class="str">"1.0"</span><span class="pln"> encoding</span><span class="pun">=</span><span class="str">"UTF-8"</span><span class="pun">?&gt;</span><span class="pln">
</span><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:p</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/p"</span><span class="pln"> </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"
  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"queue"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.support.collections.DefaultRedisList"</span><span class="tag">&gt;</span><span class="pln">
    </span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">ref</span><span class="pun">=</span><span class="atv">"redisTemplate"</span><span class="tag">/&gt;</span><span class="pln">
    </span><span class="tag">&lt;constructor-arg</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"queue-key"</span><span class="tag">/&gt;</span><span class="pln">
  </span><span class="tag">&lt;/bean&gt;</span><span class="pln">

</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows a Java configuration example for a <code>Deque</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">AnotherExample</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">// injected</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">Deque</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> queue</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> addTag</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> tag</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    queue</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">tag</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the preceding example, the consuming code is decoupled from the actual storage implementation. In fact, there is no indication that Redis is used underneath. This makes moving from development to production environments transparent and highly increases testability (the Redis implementation can be replaced with an in-memory one).</p>
</div>
<div class="sect3">
<h4 id="redis:support:cache-abstraction"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:support:cache-abstraction"></a>5.13.1. Support for the Spring Cache Abstraction</h4>
<div class="paragraph">
<p>Spring Redis provides an implementation for Spring <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/cache.html">cache abstraction</a> through the <code>org.springframework.data.redis.cache</code> package. To use Redis as a backing implementation, simply add <code>RedisCacheManager</code> to your configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-xml" data-lang="xml"><span class="tag">&lt;beans</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans"</span><span class="pln">
  </span><span class="atn">xmlns:xsi</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="pln">
  </span><span class="atn">xmlns:cache</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/cache"</span><span class="pln">
  </span><span class="atn">xmlns:c</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/c"</span><span class="pln">
  </span><span class="atn">xsi:schemaLocation</span><span class="pun">=</span><span class="atv">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd"</span><span class="tag">&gt;</span><span class="pln">

  </span><span class="com">&lt;!-- turn on declarative caching --&gt;</span><span class="pln">
  </span><span class="tag">&lt;cache:annotation-driven</span><span class="pln"> </span><span class="tag">/&gt;</span><span class="pln">

  </span><span class="com">&lt;!-- declare Redis Cache Manager --&gt;</span><span class="pln">
  </span><span class="tag">&lt;bean</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"cacheManager"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"org.springframework.data.redis.cache.RedisCacheManager"</span><span class="pln"> </span><span class="atn">c:template-ref</span><span class="pun">=</span><span class="atv">"redisTemplate"</span><span class="tag">/&gt;</span><span class="pln">
</span><span class="tag">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default <code>RedisCacheManager</code> will lazily initialize <code>RedisCache</code> whenever a <code>Cache</code> is requested. This can be changed by predefining a <code>Set</code> of cache names.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default <code>RedisCacheManager</code> will not participate in any ongoing transaction. Use <code>setTransactionAware</code> to enable transaction support.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default <code>RedisCacheManager</code> does not prefix keys for cache regions, which can lead to an unexpected growth of a <code>ZSET</code> used to maintain known keys. It’s highly recommended to enable the usage of prefixes in order to avoid this unexpected growth and potential key clashes using more than one cache region.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default <code>RedisCache</code> will not cache any <code>null</code> values as keys without a value get dropped by Redis itself. However you can explicitly enable <code>null</code> value caching via <code>RedisCacheManager</code> which will store <code>org.springframework.cache.support.NullValue</code> as a placeholder.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cluster"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#cluster"></a>6. Redis Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Working with <a href="http://redis.io/topics/cluster-spec">Redis Cluster</a> requires Redis Server version 3.0+. See the <a href="http://redis.io/topics/cluster-tutorial">Cluster Tutorial</a> for more information.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Redis Cluster is only supported by <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:jedis">jedis</a> and <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:connectors:lettuce">lettuce</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="_enabling_redis_cluster"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_enabling_redis_cluster"></a>6.1. Enabling Redis Cluster</h3>
<div class="paragraph">
<p>Cluster support is based on the same building blocks as non-clustered communication. <code>RedisClusterConnection</code>, an extension to <code>RedisConnection</code>, handles the communication with the Redis Cluster and translates errors into the Spring DAO exception hierarchy.
<code>RedisClusterConnection</code> instances are created with the <code>RedisConnectionFactory</code>, which has to be set up with the associated <code>RedisClusterConfiguration</code>, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Sample RedisConnectionFactory Configuration for Redis Cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Component</span><span class="pln">
</span><span class="lit">@ConfigurationProperties</span><span class="pun">(</span><span class="pln">prefix </span><span class="pun">=</span><span class="pln"> </span><span class="str">"spring.redis.cluster"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ClusterConfigurationProperties</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="com">/*
     * spring.redis.cluster.nodes[0] = 127.0.0.1:7379
     * spring.redis.cluster.nodes[1] = 127.0.0.1:7380
     * ...
     */</span><span class="pln">
    </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> nodes</span><span class="pun">;</span><span class="pln">

    </span><span class="com">/**
     * Get initial collection of known cluster nodes in format {@code host:port}.
     *
     * @return
     */</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> getNodes</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> nodes</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> setNodes</span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> nodes</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">nodes </span><span class="pun">=</span><span class="pln"> nodes</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="lit">@Configuration</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">AppConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="com">/**
     * Type safe representation of application.properties
     */</span><span class="pln">
    </span><span class="lit">@Autowired</span><span class="pln"> </span><span class="typ">ClusterConfigurationProperties</span><span class="pln"> clusterProperties</span><span class="pun">;</span><span class="pln">

    </span><span class="kwd">public</span><span class="pln"> </span><span class="lit">@Bean</span><span class="pln"> </span><span class="typ">RedisConnectionFactory</span><span class="pln"> connectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JedisConnectionFactory</span><span class="pun">(</span><span class="pln">
            </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisClusterConfiguration</span><span class="pun">(</span><span class="pln">clusterProperties</span><span class="pun">.</span><span class="pln">getNodes</span><span class="pun">()));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>RedisClusterConfiguration</code> can also be defined through <code>PropertySource</code> and has the following properties:</p>
</div>
<div class="ulist">
<div class="title">Configuration Properties</div>
<ul>
<li>
<p><code>spring.redis.cluster.nodes</code>: Comma-delimited list of host:port pairs.</p>
</li>
<li>
<p><code>spring.redis.cluster.max-redirects</code>: Number of allowed cluster redirections.</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The initial configuration points driver libraries to an initial set of cluster nodes. Changes resulting from live cluster reconfiguration are kept only in the native driver and are not written back to the configuration.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_redis_cluster_connection"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_working_with_redis_cluster_connection"></a>6.2. Working With Redis Cluster Connection</h3>
<div class="paragraph">
<p>As mentioned earlier, Redis Cluster behaves differently from single-node Redis or even a Sentinel-monitored master-slave environment. This is because the automatic sharding maps a key to one of 16384 slots, which are distributed across the nodes. Therefore, commands that involve more than one key must assert all keys map to the exact same slot to avoid cross-slot execution errors.
A single cluster node serves only a dedicated set of keys. Commands issued against one particular server return results only for those keys served by that server. As a simple example, consider the <code>KEYS</code> command. When issued to a server in a cluster environment, it returns only the keys served by the node the request is sent to and not necessarily all keys within the cluster. So, to get all keys in a cluster environment, you must read the keys from all the known master nodes.</p>
</div>
<div class="paragraph">
<p>While redirects for specific keys to the corresponding slot-serving node are handled by the driver libraries, higher-level functions, such as collecting information across nodes or sending commands to all nodes in the cluster, are covered by <code>RedisClusterConnection</code>. Picking up the keys example from earlier, this means that the <code>keys(pattern)</code> method picks up every master node in the cluster and simultaneously executes the <code>KEYS</code> command on every master node while picking up the results and returning the cumulated set of keys. To just request the keys of a single node <code>RedisClusterConnection</code> provides overloads for those methods (for example, <code>keys(node, pattern)</code>).</p>
</div>
<div class="paragraph">
<p>A <code>RedisClusterNode</code> can be obtained from <code>RedisClusterConnection.clusterGetNodes</code> or it can be constructed by using either the host and the port or the node Id.</p>
</div>
<div class="paragraph">
<p>The following example shows a set of commands being run across the cluster:</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Sample of Running Commands Across the Cluster</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">redis</span><span class="pun">-</span><span class="pln">cli@127</span><span class="pun">.</span><span class="lit">0.0</span><span class="pun">.</span><span class="lit">1</span><span class="pun">:</span><span class="lit">7379</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> cluster nodes

</span><span class="lit">6b38bb</span><span class="pun">...</span><span class="pln"> </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">7379</span><span class="pln"> master </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">25</span><span class="pln"> connected </span><span class="lit">0</span><span class="pun">-</span><span class="lit">5460</span><span class="pln">                      </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="lit">7bb78c</span><span class="pun">...</span><span class="pln"> </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">7380</span><span class="pln"> master </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">1449730618304</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> connected </span><span class="lit">5461</span><span class="pun">-</span><span class="lit">10922</span><span class="pln">       </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
</span><span class="lit">164888.</span><span class="pun">..</span><span class="pln"> </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">7381</span><span class="pln"> master </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">1449730618304</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> connected </span><span class="lit">10923</span><span class="pun">-</span><span class="lit">16383</span><span class="pln">      </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
b8b5ee</span><span class="pun">...</span><span class="pln"> </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">7382</span><span class="pln"> slave </span><span class="lit">6b38bb</span><span class="pun">...</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">1449730618304</span><span class="pln"> </span><span class="lit">25</span><span class="pln"> connected          </span><i class="conum" data-value="4"></i><b><span class="pun">(</span><span class="lit">4</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">RedisClusterConnection</span><span class="pln"> connection </span><span class="pun">=</span><span class="pln"> connectionFactory</span><span class="pun">.</span><span class="pln">getClusterConnnection</span><span class="pun">();</span><span class="pln">

connection</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"thing1"</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span><span class="pln">                                               </span><i class="conum" data-value="5"></i><b><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></b><span class="pln">
connection</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"thing2"</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span><span class="pln">                                               </span><i class="conum" data-value="6"></i><b><span class="pun">(</span><span class="lit">6</span><span class="pun">)</span></b><span class="pln">

connection</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">(</span><span class="str">"*"</span><span class="pun">);</span><span class="pln">                                                          </span><i class="conum" data-value="7"></i><b><span class="pun">(</span><span class="lit">7</span><span class="pun">)</span></b><span class="pln">

connection</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">(</span><span class="pln">NODE_7379</span><span class="pun">,</span><span class="pln"> </span><span class="str">"*"</span><span class="pun">);</span><span class="pln">                                               </span><i class="conum" data-value="8"></i><b><span class="pun">(</span><span class="lit">8</span><span class="pun">)</span></b><span class="pln">
connection</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">(</span><span class="pln">NODE_7380</span><span class="pun">,</span><span class="pln"> </span><span class="str">"*"</span><span class="pun">);</span><span class="pln">                                               </span><i class="conum" data-value="9"></i><b><span class="pun">(</span><span class="lit">9</span><span class="pun">)</span></b><span class="pln">
connection</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">(</span><span class="pln">NODE_7381</span><span class="pun">,</span><span class="pln"> </span><span class="str">"*"</span><span class="pun">);</span><span class="pln">                                               </span><i class="conum" data-value="10"></i><b><span class="pun">(</span><span class="lit">10</span><span class="pun">)</span></b><span class="pln">
connection</span><span class="pun">.</span><span class="pln">keys</span><span class="pun">(</span><span class="pln">NODE_7382</span><span class="pun">,</span><span class="pln"> </span><span class="str">"*"</span><span class="pun">);</span><span class="pln">                                               </span><i class="conum" data-value="11"></i><b><span class="pun">(</span><span class="lit">11</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Master node serving slots 0 to 5460 replicated to slave at 7382</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Master node serving slots 5461 to 10922</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Master node serving slots 10923 to 16383</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Slave node holding replicants of the master at 7379</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Request routed to node at 7381 serving slot 12182</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Request routed to node at 7379 serving slot 5061</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Request routed to nodes at 7379, 7380, 7381 → [thing1, thing2]</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Request routed to node at 7379 → [thing2]</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Request routed to node at 7380 → []</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Request routed to node at 7381 → [thing1]</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Request routed to node at 7382 → [thing2]</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>When all keys map to the same slot, the native driver library automatically serves cross-slot requests, such as <code>MGET</code>. However, once this is not the case, <code>RedisClusterConnection</code> executes multiple parallel <code>GET</code> commands against the slot-serving nodes and again returns an accumulated result. This is less performant than the single-slot execution and, therefore, should be used with care. If in doubt, consider pinning keys to the same slot by providing a prefix in curly brackets, such as <code>{my-prefix}.thing1</code> and <code>{my-prefix}.thing2</code>, which will both map to the same slot number. The following example shows cross-slot request handling:</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Sample of Cross-Slot Request Handling</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">redis</span><span class="pun">-</span><span class="pln">cli@127</span><span class="pun">.</span><span class="lit">0.0</span><span class="pun">.</span><span class="lit">1</span><span class="pun">:</span><span class="lit">7379</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> cluster nodes

</span><span class="lit">6b38bb</span><span class="pun">...</span><span class="pln"> </span><span class="lit">127.0</span><span class="pun">.</span><span class="lit">0.1</span><span class="pun">:</span><span class="lit">7379</span><span class="pln"> master </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="lit">25</span><span class="pln"> connected </span><span class="lit">0</span><span class="pun">-</span><span class="lit">5460</span><span class="pln">                      </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
</span><span class="lit">7bb</span><span class="pun">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">RedisClusterConnection</span><span class="pln"> connection </span><span class="pun">=</span><span class="pln"> connectionFactory</span><span class="pun">.</span><span class="pln">getClusterConnnection</span><span class="pun">();</span><span class="pln">

connection</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"thing1"</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span><span class="pln">           </span><span class="com">// slot: 12182</span><span class="pln">
connection</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"{thing1}.thing2"</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span><span class="pln">  </span><span class="com">// slot: 12182</span><span class="pln">
connection</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"thing2"</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">);</span><span class="pln">           </span><span class="com">// slot:  5461</span><span class="pln">

connection</span><span class="pun">.</span><span class="pln">mGet</span><span class="pun">(</span><span class="str">"thing1"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"{thing1}.thing2"</span><span class="pun">);</span><span class="pln">                                  </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">

connection</span><span class="pun">.</span><span class="pln">mGet</span><span class="pun">(</span><span class="str">"thing1"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"thing2"</span><span class="pun">);</span><span class="pln">                                           </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Same Configuration as in the sample before.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Keys map to same slot → 127.0.0.1:7381 MGET thing1 {thing1}.thing2</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Keys map to different slots and get split up into single slot ones routed to the according nodes<br>
→ 127.0.0.1:7379 GET thing2<br>
→ 127.0.0.1:7381 GET thing1</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The preceding examples demonstrate the general strategy followed by Spring Data Redis. Be aware that some operations might require loading huge amounts of data into memory to compute the desired command. Additionally, not all cross-slot requests can safely be ported to multiple single slot requests and error if misused (for example, <code>PFCOUNT</code>).
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_code_redistemplate_code_and_code_clusteroperations_code"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_working_with_code_redistemplate_code_and_code_clusteroperations_code"></a>6.3. Working with <code>RedisTemplate</code> and <code>ClusterOperations</code></h3>
<div class="paragraph">
<p>See the <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis:template">Working with Objects through RedisTemplate</a> section for information about the general purpose, configuration, and usage of <code>RedisTemplate</code>.</p>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Be careful when setting up <code>RedisTemplate#keySerializer</code> using any of the Json <code>RedisSerializers</code>, as changing JSON structure has immediate influence on hash slot calculation.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><code>RedisTemplate</code> provides access to cluster-specific operations through the <code>ClusterOperations</code> interface, which can be obtained from <code>RedisTemplate.opsForCluster()</code>. This lets you explicitly run commands on a single node within the cluster while retaining the serialization and deserialization features configured for the template. It also provides administrative commands (such as <code>CLUSTER MEET</code>) or more high-level operations (for example, resharding).</p>
</div>
<div class="paragraph">
<p>The following example shows how to access <code>RedisClusterConnection</code> with <code>RedisTemplate</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Accessing <code>RedisClusterConnection</code> with <code>RedisTemplate</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="typ">ClusterOperations</span><span class="pln"> clusterOps </span><span class="pun">=</span><span class="pln"> redisTemplate</span><span class="pun">.</span><span class="pln">opsForCluster</span><span class="pun">();</span><span class="pln">
clusterOps</span><span class="pun">.</span><span class="pln">shutdown</span><span class="pun">(</span><span class="pln">NODE_7379</span><span class="pun">);</span><span class="pln">                                              </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Shut down node at 7379 and cross fingers there is a slave in place that can take over.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="redis.repositories"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories"></a>7. Redis Repositories</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Working with Redis Repositories lets you seamlessly convert and store domain objects in Redis Hashes, apply custom mapping strategies, and use secondary indexes.</p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Redis Repositories requires at least Redis Server version 2.8.0.
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="redis.repositories.usage"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.usage"></a>7.1. Usage</h3>
<div class="paragraph">
<p>Spring Data Redis lets you easily implement domain entities, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Sample Person Entity</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@RedisHash</span><span class="pun">(</span><span class="str">"people"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Id</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> firstname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> lastname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">Address</span><span class="pln"> address</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>We have a pretty simple domain object here. Note that it has a <code>@RedisHash</code> annotation on its type and a property named <code>id</code> that is annotated with <code>org.springframework.data.annotation.Id</code>. Those two items are responsible for creating the actual key used to persist the hash.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Properties annotated with <code>@Id</code> as well as those named <code>id</code> are considered as the identifier properties. Those with the annotation are favored over others.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>To now actually have a component responsible for storage and retrieval, we need to define a repository interface, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. Basic Repository Interface To Persist Person Entities</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">PersonRepository</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">CrudRepository</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As our repository extends <code>CrudRepository</code>, it provides basic CRUD and finder operations. The thing we need in between to glue things together is the corresponding Spring configuration, shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. JavaConfig for Redis Repositories</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisRepositories</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ApplicationConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisConnectionFactory</span><span class="pln"> connectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JedisConnectionFactory</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisTemplate</span><span class="pun">&lt;?,</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="pln"> redisTemplate</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">RedisTemplate</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> template </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisTemplate</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> template</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Given the preceding setup, we can inject <code>PersonRepository</code> into our components, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. Access to Person Entities</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Autowired</span><span class="pln"> </span><span class="typ">PersonRepository</span><span class="pln"> repo</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> basicCrudOperations</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">Person</span><span class="pln"> rand </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Person</span><span class="pun">(</span><span class="str">"rand"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"al'thor"</span><span class="pun">);</span><span class="pln">
  rand</span><span class="pun">.</span><span class="pln">setAddress</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Address</span><span class="pun">(</span><span class="str">"emond's field"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"andor"</span><span class="pun">));</span><span class="pln">

  repo</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">rand</span><span class="pun">);</span><span class="pln">                                         </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">

  repo</span><span class="pun">.</span><span class="pln">findOne</span><span class="pun">(</span><span class="pln">rand</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">());</span><span class="pln">                              </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">

  repo</span><span class="pun">.</span><span class="pln">count</span><span class="pun">();</span><span class="pln">                                            </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">

  repo</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">(</span><span class="pln">rand</span><span class="pun">);</span><span class="pln">                                       </span><i class="conum" data-value="4"></i><b><span class="pun">(</span><span class="lit">4</span><span class="pun">)</span></b><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Generates a new <code>id</code> if the current value is <code>null</code> or reuses an already set <code>id</code> value and stores properties of type <code>Person</code> inside the Redis Hash with a key that has a pattern of <code>keyspace:id</code> — in this case, it might be <code>people:5d67b7e1-8640-4475-beeb-c666fab4c0e5</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Uses the provided <code>id</code> to retrieve the object stored at <code>keyspace:id</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Counts the total number of entities available within the keyspace, <code>people</code>, defined by <code>@RedisHash</code> on <code>Person</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Removes the key for the given object from Redis.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.mapping"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.mapping"></a>7.2. Object-to-Hash Mapping</h3>
<div class="paragraph">
<p>The Redis Repository support persists Objects to Hashes. This requires an Object-to-Hash conversion which is done by a <code>RedisConverter</code>. The default implementation uses <code>Converter</code> for mapping property values to and from Redis native <code>byte[]</code>.</p>
</div>
<div class="paragraph">
<p>Given the <code>Person</code> type from the previous sections, the default mapping looks like the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">_class </span><span class="pun">=</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">example</span><span class="pun">.</span><span class="typ">Person</span><span class="pln">                 </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
id </span><span class="pun">=</span><span class="pln"> e2c7dcee</span><span class="pun">-</span><span class="pln">b8cd</span><span class="pun">-</span><span class="lit">4424</span><span class="pun">-</span><span class="lit">883e-736ce564363e</span><span class="pln">
firstname </span><span class="pun">=</span><span class="pln"> rand                            </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
lastname </span><span class="pun">=</span><span class="pln"> al</span><span class="pun">’</span><span class="pln">thor
address</span><span class="pun">.</span><span class="pln">city </span><span class="pun">=</span><span class="pln"> emond</span><span class="str">'s field                </span><i class="conum" data-value="3"></i><b><span class="str">(3)</span></b><span class="str">
address.country = andor</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>_class</code> attribute is included on the root level as well as on any nested interface or abstract types.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Simple property values are mapped by path.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Properties of complex types are mapped by their dot path.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>The following table describes the default mapping rules:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Default Mapping Rules</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Sample</th>
<th class="tableblock halign-left valign-top">Mapped Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simple Type<br>
(for example, String)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String firstname = "rand";</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstname = "rand"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complex Type<br>
(for example, Address)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address address = new Address("emond’s field");</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">address.city = "emond’s field"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List<br>
of Simple Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;String&gt; nicknames = asList("dragon reborn", "lews therin");</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nicknames.[0] = "dragon reborn",<br>
nicknames.[1] = "lews therin"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map<br>
of Simple Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, String&gt; atts = asMap({"eye-color", "grey"}, {"…​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">atts.[eye-color] = "grey",<br>
atts.[hair-color] = "…​</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List<br>
of Complex Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;Address&gt; addresses = asList(new Address("em…​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addresses.[0].city = "emond’s field",<br>
addresses.[1].city = "…​</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map<br>
of Complex Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Address&gt; addresses = asMap({"home", new Address("em…​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addresses.[home].city = "emond’s field",<br>
addresses.[work].city = "…​</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Due to the flat representation structure, Map keys need to be simple types, such as <code>String</code> or <code>Number</code>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Mapping behavior can be customized by registering the corresponding <code>Converter</code> in <code>RedisCustomConversions</code>. Those converters can take care of converting from and to a single <code>byte[]</code> as well as <code>Map&lt;String,byte[]&gt;</code>. The first one is suitable for (for example) converting a complex type to (for example) a binary JSON representation that still uses the default mappings hash structure. The second option offers full control over the resulting hash.</p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Writing objects to a Redis hash deletes the content from the hash and re-creates the whole hash, so data that has not been mapped is lost.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The following example shows two sample byte array converters:</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. Sample byte[] Converters</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@WritingConverter</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">AddressToBytesConverter</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">Converter</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">Jackson2JsonRedisSerializer</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">&gt;</span><span class="pln"> serializer</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">AddressToBytesConverter</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    serializer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Jackson2JsonRedisSerializer</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">&gt;(</span><span class="typ">Address</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln">
    serializer</span><span class="pun">.</span><span class="pln">setObjectMapper</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ObjectMapper</span><span class="pun">());</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Override</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> convert</span><span class="pun">(</span><span class="typ">Address</span><span class="pln"> value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> serializer</span><span class="pun">.</span><span class="pln">serialize</span><span class="pun">(</span><span class="pln">value</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="lit">@ReadingConverter</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">BytesToAddressConverter</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">Converter</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="typ">Address</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">Jackson2JsonRedisSerializer</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">&gt;</span><span class="pln"> serializer</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">BytesToAddressConverter</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    serializer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Jackson2JsonRedisSerializer</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">&gt;(</span><span class="typ">Address</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln">
    serializer</span><span class="pun">.</span><span class="pln">setObjectMapper</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ObjectMapper</span><span class="pun">());</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Override</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Address</span><span class="pln"> convert</span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> serializer</span><span class="pun">.</span><span class="pln">deserialize</span><span class="pun">(</span><span class="pln">value</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the preceding byte array <code>Converter</code> produces output similar to the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">_class </span><span class="pun">=</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">example</span><span class="pun">.</span><span class="typ">Person</span><span class="pln">
id </span><span class="pun">=</span><span class="pln"> e2c7dcee</span><span class="pun">-</span><span class="pln">b8cd</span><span class="pun">-</span><span class="lit">4424</span><span class="pun">-</span><span class="lit">883e-736ce564363e</span><span class="pln">
firstname </span><span class="pun">=</span><span class="pln"> rand
lastname </span><span class="pun">=</span><span class="pln"> al</span><span class="pun">’</span><span class="pln">thor
address </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> city </span><span class="pun">:</span><span class="pln"> </span><span class="str">"emond's field"</span><span class="pun">,</span><span class="pln"> country </span><span class="pun">:</span><span class="pln"> </span><span class="str">"andor"</span><span class="pln"> </span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example shows two examples of <code>Map</code> converters:</p>
</div>
<div class="exampleblock">
<div class="title">Example 12. Sample Map&lt;String,byte[]&gt; Converters</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@WritingConverter</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">AddressToMapConverter</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">Converter</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="kwd">byte</span><span class="pun">[]&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Override</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> convert</span><span class="pun">(</span><span class="typ">Address</span><span class="pln"> source</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> singletonMap</span><span class="pun">(</span><span class="str">"ciudad"</span><span class="pun">,</span><span class="pln"> source</span><span class="pun">.</span><span class="pln">getCity</span><span class="pun">().</span><span class="pln">getBytes</span><span class="pun">());</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="lit">@ReadingConverter</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MapToAddressConverter</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">Converter</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Override</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Address</span><span class="pln"> convert</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> source</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Address</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">String</span><span class="pun">(</span><span class="pln">source</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="str">"ciudad"</span><span class="pun">)));</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Using the preceding Map <code>Converter</code> produces output similar to the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">_class </span><span class="pun">=</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">example</span><span class="pun">.</span><span class="typ">Person</span><span class="pln">
id </span><span class="pun">=</span><span class="pln"> e2c7dcee</span><span class="pun">-</span><span class="pln">b8cd</span><span class="pun">-</span><span class="lit">4424</span><span class="pun">-</span><span class="lit">883e-736ce564363e</span><span class="pln">
firstname </span><span class="pun">=</span><span class="pln"> rand
lastname </span><span class="pun">=</span><span class="pln"> al</span><span class="pun">’</span><span class="pln">thor
ciudad </span><span class="pun">=</span><span class="pln"> </span><span class="str">"emond's field"</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Custom conversions have no effect on index resolution. <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes">Secondary Indexes</a> are still created, even for custom converted types.
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_customizing_type_mapping"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_customizing_type_mapping"></a>7.2.1. Customizing Type Mapping</h4>
<div class="paragraph">
<p>If you want to avoid writing the entire Java class name as type information and would rather like to use a key, you can use the <code>@TypeAlias</code> annotation on the entity class being persisted. If you need to customize the mapping even more, look at the <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/convert/TypeInformationMapper.html"><code>TypeInformationMapper</code></a> interface. An instance of that interface can be configured at the <code>DefaultRedisTypeMapper</code>, which can be configured on <code>MappingRedisConverter</code>.</p>
</div>
<div class="paragraph">
<p>The following example shows how to define a type alias for an entity:</p>
</div>
<div class="exampleblock">
<div class="title">Example 13. Defining <code>@TypeAlias</code> for an entity</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@TypeAlias</span><span class="pun">(</span><span class="str">"pers"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The resulting document contains <code>pers</code> as the value in a <code>_class</code> field.</p>
</div>
<div class="sect4">
<h5 id="_configuring_custom_type_mapping"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_configuring_custom_type_mapping"></a>Configuring Custom Type Mapping</h5>
<div class="paragraph">
<p>The following example demonstrates how to configure a custom <code>RedisTypeMapper</code> in <code>MappingRedisConverter</code>:</p>
</div>
<div class="exampleblock">
<div class="title">Example 14. Configuring a custom <code>RedisTypeMapper</code> via Spring Java Config</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">class</span><span class="pln"> </span><span class="typ">CustomRedisTypeMapper</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">DefaultRedisTypeMapper</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">//implement custom type mapping here</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SampleRedisConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">MappingRedisConverter</span><span class="pln"> redisConverter</span><span class="pun">(</span><span class="typ">RedisMappingContext</span><span class="pln"> mappingContext</span><span class="pun">,</span><span class="pln">
        </span><span class="typ">RedisCustomConversions</span><span class="pln"> customConversions</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ReferenceResolver</span><span class="pln"> referenceResolver</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">MappingRedisConverter</span><span class="pln"> mappingRedisConverter </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MappingRedisConverter</span><span class="pun">(</span><span class="pln">mappingContext</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> referenceResolver</span><span class="pun">,</span><span class="pln">
            customTypeMapper</span><span class="pun">());</span><span class="pln">

    mappingRedisConverter</span><span class="pun">.</span><span class="pln">setCustomConversions</span><span class="pun">(</span><span class="pln">customConversions</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> mappingRedisConverter</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisTypeMapper</span><span class="pln"> customTypeMapper</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CustomRedisTypeMapper</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.keyspaces"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.keyspaces"></a>7.3. Keyspaces</h3>
<div class="paragraph">
<p>Keyspaces define prefixes used to create the actual key for the Redis Hash.
By default, the prefix is set to <code>getClass().getName()</code>. You can alter this default by setting <code>@RedisHash</code> on the aggregate root level or by setting up a programmatic configuration. However, the annotated keyspace supersedes any other configuration.</p>
</div>
<div class="paragraph">
<p>The following example shows how to set the keyspace configuration with the <code>@EnableRedisRepositories</code> annotation:</p>
</div>
<div class="exampleblock">
<div class="title">Example 15. Keyspace Setup via <code>@EnableRedisRepositories</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisRepositories</span><span class="pun">(</span><span class="pln">keyspaceConfiguration </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MyKeyspaceConfiguration</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ApplicationConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">//... RedisConnectionFactory and RedisTemplate Bean definitions omitted</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyKeyspaceConfiguration</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">KeyspaceConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="lit">@Override</span><span class="pln">
    </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Iterable</span><span class="pun">&lt;</span><span class="typ">KeyspaceSettings</span><span class="pun">&gt;</span><span class="pln"> initialConfiguration</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Collections</span><span class="pun">.</span><span class="pln">singleton</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">KeyspaceSettings</span><span class="pun">(</span><span class="typ">Person</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="str">"people"</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to programmatically set the keyspace:</p>
</div>
<div class="exampleblock">
<div class="title">Example 16. Programmatic Keyspace setup</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisRepositories</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ApplicationConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">//... RedisConnectionFactory and RedisTemplate Bean definitions omitted</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisMappingContext</span><span class="pln"> keyValueMappingContext</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisMappingContext</span><span class="pun">(</span><span class="pln">
      </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MappingConfiguration</span><span class="pun">(</span><span class="pln">
        </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MyKeyspaceConfiguration</span><span class="pun">(),</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">IndexConfiguration</span><span class="pun">()));</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyKeyspaceConfiguration</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">KeyspaceConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="lit">@Override</span><span class="pln">
    </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Iterable</span><span class="pun">&lt;</span><span class="typ">KeyspaceSettings</span><span class="pun">&gt;</span><span class="pln"> initialConfiguration</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Collections</span><span class="pun">.</span><span class="pln">singleton</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">KeyspaceSettings</span><span class="pun">(</span><span class="typ">Person</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="str">"people"</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.indexes"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes"></a>7.4. Secondary Indexes</h3>
<div class="paragraph">
<p><a href="http://redis.io/topics/indexes">Secondary indexes</a> are used to enable lookup operations based on native Redis structures. Values are written to the according indexes on every save and are removed when objects are deleted or <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.expirations">expire</a>.</p>
</div>
<div class="sect3">
<h4 id="redis.repositories.indexes.simple"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes.simple"></a>7.4.1. Simple Property Index</h4>
<div class="paragraph">
<p>Given the sample <code>Person</code> entity shown earlier, we can create an index for <code>firstname</code> by annotating the property with <code>@Indexed</code>, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. Annotation driven indexing</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@RedisHash</span><span class="pun">(</span><span class="str">"people"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Id</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">
  </span><span class="lit">@Indexed</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> firstname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">String</span><span class="pln"> lastname</span><span class="pun">;</span><span class="pln">
  </span><span class="typ">Address</span><span class="pln"> address</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Indexes are built up for actual property values. Saving two Persons (for example, "rand" and "aviendha") results in setting up indexes similar to the following:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">SADD people</span><span class="pun">:</span><span class="pln">firstname</span><span class="pun">:</span><span class="pln">rand e2c7dcee</span><span class="pun">-</span><span class="pln">b8cd</span><span class="pun">-</span><span class="lit">4424</span><span class="pun">-</span><span class="lit">883e-736ce564363e</span><span class="pln">
SADD people</span><span class="pun">:</span><span class="pln">firstname</span><span class="pun">:</span><span class="pln">aviendha a9d4b3a0</span><span class="pun">-</span><span class="lit">50d3</span><span class="pun">-</span><span class="lit">4538</span><span class="pun">-</span><span class="pln">a2fc</span><span class="pun">-</span><span class="pln">f7fc2581ee56</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>It is also possible to have indexes on nested elements. Assume <code>Address</code> has a <code>city</code> property that is annotated with <code>@Indexed</code>. In that case, once <code>person.address.city</code> is not <code>null</code>, we have Sets for each city, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">SADD people</span><span class="pun">:</span><span class="pln">address</span><span class="pun">.</span><span class="pln">city</span><span class="pun">:</span><span class="pln">tear e2c7dcee</span><span class="pun">-</span><span class="pln">b8cd</span><span class="pun">-</span><span class="lit">4424</span><span class="pun">-</span><span class="lit">883e-736ce564363e</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Furthermore, the programmatic setup lets you define indexes on map keys and list properties, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@RedisHash</span><span class="pun">(</span><span class="str">"people"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">// ... other properties omitted</span><span class="pln">

  </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> attributes</span><span class="pun">;</span><span class="pln">      </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
  </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pln"> </span><span class="typ">Person</span><span class="pun">&gt;</span><span class="pln"> relatives</span><span class="pun">;</span><span class="pln">       </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
  </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Address</span><span class="pun">&gt;</span><span class="pln"> addresses</span><span class="pun">;</span><span class="pln">            </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>SADD people:attributes.map-key:map-value e2c7dcee-b8cd-4424-883e-736ce564363e</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>SADD people:relatives.map-key.firstname:tam e2c7dcee-b8cd-4424-883e-736ce564363e</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>SADD people:addresses.city:tear e2c7dcee-b8cd-4424-883e-736ce564363e</code></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Indexes cannot be resolved on <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.references">References</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>As with keyspaces, you can configure indexes without needing to annotate the actual domain type, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 18. Index Setup with @EnableRedisRepositories</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisRepositories</span><span class="pun">(</span><span class="pln">indexConfiguration </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MyIndexConfiguration</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ApplicationConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">//... RedisConnectionFactory and RedisTemplate Bean definitions omitted</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyIndexConfiguration</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">IndexConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="lit">@Override</span><span class="pln">
    </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Iterable</span><span class="pun">&lt;</span><span class="typ">IndexDefinition</span><span class="pun">&gt;</span><span class="pln"> initialConfiguration</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Collections</span><span class="pun">.</span><span class="pln">singleton</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SimpleIndexDefinition</span><span class="pun">(</span><span class="str">"people"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"firstname"</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Again, as with keyspaces, you can programmatically configure indexes, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 19. Programmatic Index setup</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@Configuration</span><span class="pln">
</span><span class="lit">@EnableRedisRepositories</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">ApplicationConfig</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="com">//... RedisConnectionFactory and RedisTemplate Bean definitions omitted</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">RedisMappingContext</span><span class="pln"> keyValueMappingContext</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisMappingContext</span><span class="pun">(</span><span class="pln">
      </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MappingConfiguration</span><span class="pun">(</span><span class="pln">
        </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">KeyspaceConfiguration</span><span class="pun">(),</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MyIndexConfiguration</span><span class="pun">()));</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyIndexConfiguration</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">IndexConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="lit">@Override</span><span class="pln">
    </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">Iterable</span><span class="pun">&lt;</span><span class="typ">IndexDefinition</span><span class="pun">&gt;</span><span class="pln"> initialConfiguration</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Collections</span><span class="pun">.</span><span class="pln">singleton</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SimpleIndexDefinition</span><span class="pun">(</span><span class="str">"people"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"firstname"</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redis.repositories.indexes.geospatial"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.indexes.geospatial"></a>7.4.2. Geospatial Index</h4>
<div class="paragraph">
<p>Assume the <code>Address</code> type contains a <code>location</code> property of type <code>Point</code> that holds the geo coordinates of the particular address. By annotating the property with <code>@GeoIndexed</code>, Spring Data Redis adds those values by using Redis <code>GEO</code> commands, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="lit">@RedisHash</span><span class="pun">(</span><span class="str">"people"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Person</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">Address</span><span class="pln"> address</span><span class="pun">;</span><span class="pln">

  </span><span class="com">// ... other properties omitted</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Address</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@GeoIndexed</span><span class="pln"> </span><span class="typ">Point</span><span class="pln"> location</span><span class="pun">;</span><span class="pln">

  </span><span class="com">// ... other properties omitted</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">PersonRepository</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">CrudRepository</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;</span><span class="pln"> findByAddressLocationNear</span><span class="pun">(</span><span class="typ">Point</span><span class="pln"> point</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Distance</span><span class="pln"> distance</span><span class="pun">);</span><span class="pln">     </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
  </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;</span><span class="pln"> findByAddressLocationWithin</span><span class="pun">(</span><span class="typ">Circle</span><span class="pln"> circle</span><span class="pun">);</span><span class="pln">                    </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="typ">Person</span><span class="pln"> rand </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Person</span><span class="pun">(</span><span class="str">"rand"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"al'thor"</span><span class="pun">);</span><span class="pln">
rand</span><span class="pun">.</span><span class="pln">setAddress</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Address</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Point</span><span class="pun">(</span><span class="lit">13.361389D</span><span class="pun">,</span><span class="pln"> </span><span class="lit">38.115556D</span><span class="pun">)));</span><span class="pln">

repository</span><span class="pun">.</span><span class="pln">save</span><span class="pun">(</span><span class="pln">rand</span><span class="pun">);</span><span class="pln">                                                        </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">

repository</span><span class="pun">.</span><span class="pln">findByAddressLocationNear</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Point</span><span class="pun">(</span><span class="lit">15D</span><span class="pun">,</span><span class="pln"> </span><span class="lit">37D</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Distance</span><span class="pun">(</span><span class="lit">200</span><span class="pun">));</span><span class="pln"> </span><i class="conum" data-value="4"></i><b><span class="pun">(</span><span class="lit">4</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Query method declaration on a nested property, using <code>Point</code> and <code>Distance</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Query method declaration on a nested property, using <code>Circle</code> to search within.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>GEOADD people:address:location 13.361389 38.115556 e2c7dcee-b8cd-4424-883e-736ce564363e</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>GEORADIUS people:address:location 15.0 37.0 200.0 km</code></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="paragraph">
<p>In the preceding example the, longitude and latitude values are stored by using <code>GEOADD</code> that use the object’s <code>id</code> as the member’s name. The finder methods allow usage of <code>Circle</code> or <code>Point, Distance</code> combinations for querying those values.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is <strong>not</strong> possible to combine <code>near</code> and <code>within</code> with other criteria.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.expirations"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.expirations"></a>7.5. Time To Live</h3>
<div class="paragraph">
<p>Objects stored in Redis may be valid only for a certain amount of time. This is especially useful for persisting short-lived objects in Redis without having to remove them manually when they reach their end of life. The expiration time in seconds can be set with <code>@RedisHash(timeToLive=…​)</code> as well as by using <code>KeyspaceSettings</code> (see <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.keyspaces">Keyspaces</a>).</p>
</div>
<div class="paragraph">
<p>More flexible expiration times can be set by using the <code>@TimeToLive</code> annotation on either a numeric property or a method. However, do not apply <code>@TimeToLive</code> on both a method and a property within the same class. The following example shows the <code>@TimeToLive</code> annotation on a property and on a method:</p>
</div>
<div class="exampleblock">
<div class="title">Example 20. Expirations</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">TimeToLiveOnProperty</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Id</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">

  </span><span class="lit">@TimeToLive</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> expiration</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">TimeToLiveOnMethod</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Id</span><span class="pln">
  </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">

  </span><span class="lit">@TimeToLive</span><span class="pln">
  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> getTimeToLive</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Random</span><span class="pun">().</span><span class="pln">nextLong</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Annotating a property explicitly with <code>@TimeToLive</code> reads back the actual <code>TTL</code> or <code>PTTL</code> value from Redis. -1 indicates that the object has no associated expiration.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>The repository implementation ensures subscription to <a href="http://redis.io/topics/notifications">Redis keyspace notifications</a> via <code>RedisMessageListenerContainer</code>.</p>
</div>
<div class="paragraph">
<p>When the expiration is set to a positive value, the corresponding <code>EXPIRE</code> command is executed. In addition to persisting the original, a phantom copy is persisted in Redis and set to expire five minutes after the original one. This is done to enable the Repository support to publish <code>RedisKeyExpiredEvent</code>, holding the expired value in Spring’s <code>ApplicationEventPublisher</code> whenever a key expires, even though the original values have already been removed. Expiry events are received on all connected applications that use Spring Data Redis repositories.</p>
</div>
<div class="paragraph">
<p>By default, the key expiry listener is disabled when initializing the application. The startup mode can be adjusted in <code>@EnableRedisRepositories</code> or <code>RedisKeyValueAdapter</code> to start the listener with the application or upon the first insert of an entity with a TTL. See <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/api/org/springframework/data/redis/core/RedisKeyValueAdapter.EnableKeyspaceEvents.html"><code>EnableKeyspaceEvents</code></a> for possible values.</p>
</div>
<div class="paragraph">
<p>The <code>RedisKeyExpiredEvent</code> holds a copy of the expired domain object as well as the key.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Delaying or disabling the expiry event listener startup impacts <code>RedisKeyExpiredEvent</code> publishing. A disabled event listener does not publish expiry events. A delayed startup can cause loss of events because of the delayed listener initialization.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The keyspace notification message listener alters <code>notify-keyspace-events</code> settings in Redis, if those are not already set. Existing settings are not overridden, so you must set up those settings correctly (or leave them empty). Note that <code>CONFIG</code> is disabled on AWS ElastiCache, and enabling the listener leads to an error.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Redis Pub/Sub messages are not persistent. If a key expires while the application is down, the expiry event is not processed, which may lead to secondary indexes containing references to the expired object.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.references"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.references"></a>7.6. Persisting References</h3>
<div class="paragraph">
<p>Marking properties with <code>@Reference</code> allows storing a simple key reference instead of copying values into the hash itself.
On loading from Redis, references are resolved automatically and mapped back into the object, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 21. Sample Property Reference</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-text" data-lang="text"><span class="pln">_class </span><span class="pun">=</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">example</span><span class="pun">.</span><span class="typ">Person</span><span class="pln">
id </span><span class="pun">=</span><span class="pln"> e2c7dcee</span><span class="pun">-</span><span class="pln">b8cd</span><span class="pun">-</span><span class="lit">4424</span><span class="pun">-</span><span class="lit">883e-736ce564363e</span><span class="pln">
firstname </span><span class="pun">=</span><span class="pln"> rand
lastname </span><span class="pun">=</span><span class="pln"> al</span><span class="pun">’</span><span class="pln">thor
mother </span><span class="pun">=</span><span class="pln"> people</span><span class="pun">:</span><span class="pln">a9d4b3a0</span><span class="pun">-</span><span class="lit">50d3</span><span class="pun">-</span><span class="lit">4538</span><span class="pun">-</span><span class="pln">a2fc</span><span class="pun">-</span><span class="pln">f7fc2581ee56      </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Reference stores the whole key (<code>keyspace:id</code>) of the referenced object.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Referenced Objects are not persisted when the referencing object is saved. You must persist changes on referenced objects separately, since only the reference is stored. Indexes set on properties of referenced types are not resolved.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.partial-updates"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.partial-updates"></a>7.7. Persisting Partial Updates</h3>
<div class="paragraph">
<p>In some cases, you need not load and rewrite the entire entity just to set a new value within it. A session timestamp for the last active time might be such a scenario where you want to alter one property.
<code>PartialUpdate</code> lets you define <code>set</code> and <code>delete</code> actions on existing objects while taking care of updating potential expiration times of both the entity itself and index structures. The following example shows a partial update:</p>
</div>
<div class="exampleblock">
<div class="title">Example 22. Sample Partial Update</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">PartialUpdate</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;</span><span class="pln"> update </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PartialUpdate</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;(</span><span class="str">"e2c7dcee"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Person</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"firstname"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"mat"</span><span class="pun">)</span><span class="pln">                                                           </span><i class="conum" data-value="1"></i><b><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span></b><span class="pln">
  </span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"address.city"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"emond's field"</span><span class="pun">)</span><span class="pln">                                              </span><i class="conum" data-value="2"></i><b><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></b><span class="pln">
  </span><span class="pun">.</span><span class="pln">del</span><span class="pun">(</span><span class="str">"age"</span><span class="pun">);</span><span class="pln">                                                                       </span><i class="conum" data-value="3"></i><b><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></b><span class="pln">

template</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">update</span><span class="pun">);</span><span class="pln">

update </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PartialUpdate</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;(</span><span class="str">"e2c7dcee"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Person</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"address"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Address</span><span class="pun">(</span><span class="str">"caemlyn"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"andor"</span><span class="pun">))</span><span class="pln">                                   </span><i class="conum" data-value="4"></i><b><span class="pun">(</span><span class="lit">4</span><span class="pun">)</span></b><span class="pln">
  </span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"attributes"</span><span class="pun">,</span><span class="pln"> singletonMap</span><span class="pun">(</span><span class="str">"eye-color"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"grey"</span><span class="pun">));</span><span class="pln">                             </span><i class="conum" data-value="5"></i><b><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></b><span class="pln">

template</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">update</span><span class="pun">);</span><span class="pln">

update </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PartialUpdate</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;(</span><span class="str">"e2c7dcee"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Person</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">)</span><span class="pln">
  </span><span class="pun">.</span><span class="pln">refreshTtl</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span><span class="pln">                                                                 </span><i class="conum" data-value="6"></i><b><span class="pun">(</span><span class="lit">6</span><span class="pun">)</span></b><span class="pln">
  </span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"expiration"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span><span class="pln">

template</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln">update</span><span class="pun">);</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set the simple <code>firstname</code> property to <code>mat</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the simple 'address.city' property to 'emond’s field' without having to pass in the entire object. This does not work when a custom conversion is registered.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Remove the <code>age</code> property.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Set complex <code>address</code> property.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Set a map of values, which removes the previously existing map and replaces the values with the given ones.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Automatically update the server expiration time when altering <a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.expirations">Time To Live</a>.</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Updating complex objects as well as map (or other collection) structures requires further interaction with Redis to determine existing values, which means that rewriting the entire entity might be faster.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.queries"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.queries"></a>7.8. Queries and Query Methods</h3>
<div class="paragraph">
<p>Query methods allow automatic derivation of simple finder queries from the method name, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 23. Sample Repository finder Method</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">PersonRepository</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">CrudRepository</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;</span><span class="pln"> findByFirstname</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> firstname</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please make sure properties used in finder methods are set up for indexing.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Query methods for Redis repositories support only queries for entities and collections of entities with paging.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Using derived query methods might not always be sufficient to model the queries to execute. <code>RedisCallback</code> offers more control over the actual matching of index structures or even custom indexes. To do so, provide a <code>RedisCallback</code> that returns a single or <code>Iterable</code> set of <code>id</code> values, as shown in the following example:</p>
</div>
<div class="exampleblock">
<div class="title">Example 24. Sample finder using RedisCallback</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="typ">String</span><span class="pln"> user </span><span class="pun">=</span><span class="pln"> </span><span class="com">//...</span><span class="pln">

</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">RedisSession</span><span class="pun">&gt;</span><span class="pln"> sessionsByUser </span><span class="pun">=</span><span class="pln"> template</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisCallback</span><span class="pun">&lt;</span><span class="typ">Set</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[]&gt;&gt;()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Set</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> doInRedis</span><span class="pun">(</span><span class="typ">RedisConnection</span><span class="pln"> connection</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">DataAccessException</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> connection
      </span><span class="pun">.</span><span class="pln">sMembers</span><span class="pun">(</span><span class="str">"sessions:securityContext.authentication.principal.username:"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> user</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}},</span><span class="pln"> </span><span class="typ">RedisSession</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following table provides an overview of the keywords supported for Redis and what a method containing that keyword essentially translates to:</p>
</div>
<div class="exampleblock">
<div class="content">
<table class="tableblock frame-all grid-all">
<caption class="title">Table 5. Supported keywords inside method names</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Sample</th>
<th class="tableblock halign-left valign-top">Redis snippet</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>And</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>findByLastnameAndFirstname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SINTER …:firstname:rand …:lastname:al’thor</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>findByLastnameOrFirstname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SUNION …:firstname:rand …:lastname:al’thor</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Is,Equals</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>findByFirstname</code>,<code>findByFirstnameIs</code>,<code>findByFirstnameEquals</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SINTER …:firstname:rand</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Top,First</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>findFirst10ByFirstname</code>,<code>findTop5ByFirstname</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.cluster"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.cluster"></a>7.9. Redis Repositories Running on a Cluster</h3>
<div class="paragraph">
<p>You can use the Redis repository support in a clustered Redis environment. See the “<a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#cluster">Redis Cluster</a>” section for <code>ConnectionFactory</code> configuration details. Still, some additional configuration must be done, because the default key distribution spreads entities and secondary indexes through out the whole cluster and its slots.</p>
</div>
<div class="paragraph">
<p>The following table shows the details of data on a cluster (based on previous examples):</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Slot</th>
<th class="tableblock halign-left valign-top">Node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">people:e2c7dcee-b8cd-4424-883e-736ce564363e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id for hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15171</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:7381</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">people:a9d4b3a0-50d3-4538-a2fc-f7fc2581ee56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id for hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7373</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:7380</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">people:firstname:rand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1700</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:7379</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Some commands (such as <code>SINTER</code> and <code>SUNION</code>) can only be processed on the server side when all involved keys map to the same slot. Otherwise, computation has to be done on client side. Therefore, it is useful to pin keyspaces to a single slot, which lets make use of Redis server side computation right away. The following table shows what happens when you do (note the change in the slot column and the port value in the node column):</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Slot</th>
<th class="tableblock halign-left valign-top">Node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">{people}:e2c7dcee-b8cd-4424-883e-736ce564363e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id for hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2399</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:7379</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">{people}:a9d4b3a0-50d3-4538-a2fc-f7fc2581ee56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">id for hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2399</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:7379</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">{people}:firstname:rand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2399</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:7379</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Define and pin keyspaces by using <code>@RedisHash("{yourkeyspace}")</code> to specific slots when you use Redis cluster.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="redis.repositories.cdi-integration"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#redis.repositories.cdi-integration"></a>7.10. CDI Integration</h3>
<div class="paragraph">
<p>Instances of the repository interfaces are usually created by a container, for which Spring is the most natural choice when working with Spring Data. Spring offers sophisticated for creating bean instances. Spring Data Redis ships with a custom CDI extension that lets you use the repository abstraction in CDI environments. The extension is part of the JAR, so, to activate it, drop the Spring Data Redis JAR into your classpath.</p>
</div>
<div class="paragraph">
<p>You can then set up the infrastructure by implementing a CDI Producer for the <code>RedisConnectionFactory</code> and <code>RedisOperations</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">class</span><span class="pln"> </span><span class="typ">RedisOperationsProducer</span><span class="pln"> </span><span class="pun">{</span><span class="pln">


  </span><span class="lit">@Produces</span><span class="pln">
  </span><span class="typ">RedisConnectionFactory</span><span class="pln"> redisConnectionFactory</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">JedisConnectionFactory</span><span class="pln"> jedisConnectionFactory </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JedisConnectionFactory</span><span class="pun">();</span><span class="pln">
    jedisConnectionFactory</span><span class="pun">.</span><span class="pln">setHostName</span><span class="pun">(</span><span class="str">"localhost"</span><span class="pun">);</span><span class="pln">
    jedisConnectionFactory</span><span class="pun">.</span><span class="pln">setPort</span><span class="pun">(</span><span class="lit">6379</span><span class="pun">);</span><span class="pln">
    jedisConnectionFactory</span><span class="pun">.</span><span class="pln">afterPropertiesSet</span><span class="pun">();</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> jedisConnectionFactory</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="kwd">void</span><span class="pln"> disposeRedisConnectionFactory</span><span class="pun">(</span><span class="lit">@Disposes</span><span class="pln"> </span><span class="typ">RedisConnectionFactory</span><span class="pln"> redisConnectionFactory</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">redisConnectionFactory </span><span class="kwd">instanceof</span><span class="pln"> </span><span class="typ">DisposableBean</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="pun">((</span><span class="typ">DisposableBean</span><span class="pun">)</span><span class="pln"> redisConnectionFactory</span><span class="pun">).</span><span class="pln">destroy</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

  </span><span class="lit">@Produces</span><span class="pln">
  </span><span class="lit">@ApplicationScoped</span><span class="pln">
  </span><span class="typ">RedisOperations</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> redisOperationsProducer</span><span class="pun">(</span><span class="typ">RedisConnectionFactory</span><span class="pln"> redisConnectionFactory</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="typ">RedisTemplate</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;</span><span class="pln"> template </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RedisTemplate</span><span class="pun">&lt;</span><span class="kwd">byte</span><span class="pun">[],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pun">[]&gt;();</span><span class="pln">
    template</span><span class="pun">.</span><span class="pln">setConnectionFactory</span><span class="pun">(</span><span class="pln">redisConnectionFactory</span><span class="pun">);</span><span class="pln">
    template</span><span class="pun">.</span><span class="pln">afterPropertiesSet</span><span class="pun">();</span><span class="pln">

    </span><span class="kwd">return</span><span class="pln"> template</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The necessary setup can vary, depending on your JavaEE environment.</p>
</div>
<div class="paragraph">
<p>The Spring Data Redis CDI extension picks up all available repositories as CDI beans and creates a proxy for a Spring Data repository whenever a bean of a repository type is requested by the container. Thus, obtaining an instance of a Spring Data repository is a matter of declaring an <code>@Injected</code> property, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight prettyprinted" style=""><code class="language-java" data-lang="java"><span class="kwd">class</span><span class="pln"> </span><span class="typ">RepositoryClient</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="lit">@Inject</span><span class="pln">
  </span><span class="typ">PersonRepository</span><span class="pln"> repository</span><span class="pun">;</span><span class="pln">

  </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> businessMethod</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Person</span><span class="pun">&gt;</span><span class="pln"> people </span><span class="pun">=</span><span class="pln"> repository</span><span class="pun">.</span><span class="pln">findAll</span><span class="pun">();</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A Redis Repository requires <code>RedisKeyValueAdapter</code> and <code>RedisKeyValueTemplate</code> instances. These beans are created and managed by the Spring Data CDI extension if no provided beans are found. You can, however, supply your own beans to configure the specific properties of <code>RedisKeyValueAdapter</code> and <code>RedisKeyValueTemplate</code>.</p>
</div>
</div>
</div>
</div>
<h1 id="appendixes" class="sect0"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendixes"></a>Appendixes</h1>
<div class="openblock partintro">
<div class="content">
<h2 id="_appendix_document_structure" class="float">Appendix Document Structure</h2>
<div class="paragraph">
<p>The appendix contains various additional detail that complements the information in the rest of the reference documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>“<a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendix:schema">Schema</a>” defines the schemas provided by Spring Data Redis.</p>
</li>
<li>
<p>“<a href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendix:command-reference">Command Reference</a>” details which commands are supported by <code>RedisTemplate</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix:schema"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendix:schema"></a>Appendix A: Schema</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://www.springframework.org/schema/redis/spring-redis-1.0.xsd">Spring Data Redis Schema (redis-namespace)</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendix:command-reference"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#appendix:command-reference"></a>Appendix B: Command Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_supported_commands"><a class="anchor" href="https://docs.spring.io/spring-data/redis/docs/1.8.12.RELEASE/reference/html/#_supported_commands"></a>Supported Commands</h3>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<caption class="title">Table 6. Redis commands supported by <code>RedisTemplate</code></caption>
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Command</th>
<th class="tableblock halign-center valign-top">Template Support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">APPEND</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUTH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BGREWRITEAOF</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BGSAVE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BITCOUNT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BITOP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLPOP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BRPOP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BRPOPLPUSH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT KILL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT GETNAME</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT LIST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT SETNAME</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLUSTER SLOTS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMMAND</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMMAND COUNT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMMAND GETKEYS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMMAND INFO</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG GET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG RESETSTAT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG REWRITE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG SET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DBSIZE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG OBJECT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG SEGFAULT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DECR</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DECRBY</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DISCARD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DUMP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECHO</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EVAL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EVALSHA</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXEC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXISTS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXPIRE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXPIREAT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLUSHALL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLUSHDB</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GETBIT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GETRANGE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GETSET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HDEL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HEXISTS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HGET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HGETALL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HINCRBY</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HINCRBYFLOAT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HKEYS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HLEN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMGET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMSET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSCAN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSETNX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HVALS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INCR</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INCRBY</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INCRBYFLOAT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KEYS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LASTSAVE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LINDEX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LINSERT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LLEN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPOP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPUSH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LPUSHX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LRANGE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LREM</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LSET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LTRIM</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MGET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIGRATE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONITOR</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MOVE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MSET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MSETNX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MULTI</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBJECT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERSIST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEXIPRE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEXPIREAT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PFADD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PFCOUNT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PFMERGE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PING</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PSETEX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PSUBSCRIBE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTTL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUBLISH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUBSUB</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUBSUBSCRIBE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QUIT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RANDOMKEY</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RENAME</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RENAMENX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ROLE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPOP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPOPLPUSH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPUSH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPUSHX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SADD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SAVE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCAN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCARD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRIPT EXITS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRIPT FLUSH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRIPT KILL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRIPT LOAD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SDIFF</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SDIFFSTORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SELECT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL FAILOVER</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL GET-MASTER-ADD-BY-NAME</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL MASTER</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL MASTERS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL MONITOR</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL REMOVE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL RESET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL SET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SENTINEL SLAVES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SET</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETBIT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETEX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETNX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETRANGE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHUTDOWN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SINTER</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SINTERSTORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SISMEMBER</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SLAVEOF</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SLOWLOG</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMEMBERS</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMOVE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SORT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPOP</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRANDMEMBER</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SREM</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSCAN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRLEN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBSCRIBE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUNION</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUNIONSTORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SYNC</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TTL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TYPE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNSUBSCRIBE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNWATCH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WATCH</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZADD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZCARD</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZCOUNT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZINCRBY</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZINTERSTORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZLEXCOUNT</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZRANGE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZRANGEBYLEX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREVRANGEBYLEX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZRANGEBYSCORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZRANK</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREM</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREMRANGEBYLEX</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREMRANGEBYRANK</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREVRANGE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREVRANGEBYSCORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZREVRANK</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZSCAN</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZSCORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZUNINONSTORE</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">X</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.8.12.RELEASE<br>
Last updated 2018-05-08 10:48:18 MESZ
</div>
</div>
<link rel="stylesheet" href="./Spring Data Redis_files/prettify.min.css">
<script async="" src="./Spring Data Redis_files/analytics.js.下载"></script><script src="./Spring Data Redis_files/prettify.min.js.下载"></script>
<script>prettyPrint()</script>
<script>if(window.parent==window){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-2728886-23','auto',{'siteSpeedSampleRate':100});ga('send','pageview');}</script>
</body></html>